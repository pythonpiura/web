<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Python Piura (Publicaciones sobre pytesseract)</title><link>http://pythonpiura.org/</link><description></description><atom:link type="application/rss+xml" rel="self" href="http://pythonpiura.org/categories/pytesseract.xml"></atom:link><language>es</language><lastBuildDate>Tue, 17 Jan 2017 04:52:59 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Consulta DNI - RENIEC</title><link>http://pythonpiura.org/posts/2016/05/11/consulta-dni-reniec/</link><dc:creator>Comunidad Python Piura</dc:creator><description>&lt;div&gt;&lt;p&gt;En esta oportunidad vamos a hacer un ejemplo mas complejo, ya que el
captcha así lo amerita, nuestra página objetivo es la siguiente:&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://cel.reniec.gob.pe/valreg/valreg.do"&gt;https://cel.reniec.gob.pe/valreg/valreg.do&lt;/a&gt;&lt;/p&gt;
&lt;img alt="/images/blog/reniec.jpg" src="http://pythonpiura.org/images/blog/reniec.jpg"&gt;
&lt;p&gt;En esta página podemos ingresar el número de DNI y obtener el nombre
completo del ciudadano. Como se ve en la imagen aquí nos enfrentamos a
un captcha mas completo y a un teclado dinámico compuesto de botones,
para romper este captcha tenemos que modificar la imagen para obtener
el texto correcto, eliminando las lineas que atraviesan las letras y
que tienen una tonalidad distinta de azul, el proceso no será 100%
seguro pero funciona en la mayoría de los casos:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# -*- coding: utf-8 -*-&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;webdriver&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium.webdriver.common.by&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;By&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium.webdriver.support.wait&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;WebDriverWait&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium.webdriver.support&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;expected_conditions&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;EC&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-6"&gt;&lt;/a&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-7"&gt;&lt;/a&gt;&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-8"&gt;&lt;/a&gt;        &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;Image&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-9"&gt;&lt;/a&gt;&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;ImportError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-10"&gt;&lt;/a&gt;        &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PIL&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Image&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-11"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pytesseract&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-12"&gt;&lt;/a&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-13"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;ir_reniec_web&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dni&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-14"&gt;&lt;/a&gt;        &lt;span class="n"&gt;fp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;webdriver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;FirefoxProfile&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-15"&gt;&lt;/a&gt;        &lt;span class="n"&gt;driver&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;webdriver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Firefox&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-16"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Definimos nuestra página objetivo&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-17"&gt;&lt;/a&gt;        &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"https://cel.reniec.gob.pe/valreg/valreg.do"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-18"&gt;&lt;/a&gt;        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-19"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Esperamos hasta que se cargue la imagen con el captcha&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-20"&gt;&lt;/a&gt;                &lt;span class="n"&gt;WebDriverWait&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;until&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;EC&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;presence_of_element_located&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;By&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ID&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"imagcodigo"&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-21"&gt;&lt;/a&gt;        &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-22"&gt;&lt;/a&gt;                &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;"Element is not present"&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-23"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Hacemos la captura de pantalla correspondiente&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-24"&gt;&lt;/a&gt;        &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save_screenshot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"screenshot.png"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-25"&gt;&lt;/a&gt;        &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'screenshot.png'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-26"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Obtenemos el ancho y el largo de la imagen&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-27"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ancho&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-28"&gt;&lt;/a&gt;        &lt;span class="n"&gt;alto&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-29"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Recortamos la parte del captcha teniendo en cuenta el ancho y el largo de la imagen&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-30"&gt;&lt;/a&gt;        &lt;span class="n"&gt;img_recortada&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;crop&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ancho&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;4.26&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;alto&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;3.64&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ancho&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;2.8&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;alto&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-31"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Guardamos el recorte&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-32"&gt;&lt;/a&gt;        &lt;span class="n"&gt;img_recortada&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"recorte.png"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-33"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Recorremos cada uno de los dígitos del DNI&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-34"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;dni&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-35"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Buscamos el boton que tenga como nombre tecla_0&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-36"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_0"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-37"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el valor del botón con nombre tecla_0&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-38"&gt;&lt;/a&gt;                &lt;span class="n"&gt;valor_0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;boton_0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_attribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'value'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-39"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Buscamos el boton que tenga como nombre tecla_1&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-40"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_1"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-41"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el valor del botón con nombre tecla_1&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-42"&gt;&lt;/a&gt;                &lt;span class="n"&gt;valor_1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;boton_1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_attribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'value'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-43"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Buscamos el boton que tenga como nombre tecla_2&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-44"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_2"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-45"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el valor del botón con nombre tecla_2&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-46"&gt;&lt;/a&gt;                &lt;span class="n"&gt;valor_2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;boton_2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_attribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'value'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-47"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Buscamos el boton que tenga como nombre tecla_3&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-48"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_3"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-49"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el valor del botón con nombre tecla_3&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-50"&gt;&lt;/a&gt;                &lt;span class="n"&gt;valor_3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;boton_3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_attribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'value'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-51"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Buscamos el boton que tenga como nombre tecla_4&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-52"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_4&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_4"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-53"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el valor del botón con nombre tecla_4&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-54"&gt;&lt;/a&gt;                &lt;span class="n"&gt;valor_4&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;boton_4&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_attribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'value'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-55"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Buscamos el boton que tenga como nombre tecla_5&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-56"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_5&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_5"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-57"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el valor del botón con nombre tecla_5&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-58"&gt;&lt;/a&gt;                &lt;span class="n"&gt;valor_5&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;boton_5&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_attribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'value'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-59"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Buscamos el boton que tenga como nombre tecla_6&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-60"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_6&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_6"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-61"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el valor del botón con nombre tecla_6&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-62"&gt;&lt;/a&gt;                &lt;span class="n"&gt;valor_6&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;boton_6&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_attribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'value'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-63"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Buscamos el boton que tenga como nombre tecla_7&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-64"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_7&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_7"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-65"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el valor del botón con nombre tecla_7&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-66"&gt;&lt;/a&gt;                &lt;span class="n"&gt;valor_7&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;boton_7&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_attribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'value'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-67"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Buscamos el boton que tenga como nombre tecla_8&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-68"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_8&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_8"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-69"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el valor del botón con nombre tecla_8&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-70"&gt;&lt;/a&gt;                &lt;span class="n"&gt;valor_8&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;boton_8&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_attribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'value'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-71"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Buscamos el boton que tenga como nombre tecla_9&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-72"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_9&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_9"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-73"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el valor del botón con nombre tecla_9&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-74"&gt;&lt;/a&gt;                &lt;span class="n"&gt;valor_9&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;boton_9&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_attribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'value'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-75"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Consultamos si el dígito del DNI es igual al valor del botón, si es el caso entonces se da click en ese botón&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-76"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;valor_0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-77"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-78"&gt;&lt;/a&gt;        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;valor_1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-79"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_1"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-80"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-81"&gt;&lt;/a&gt;        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;valor_2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-82"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_2"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-83"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-84"&gt;&lt;/a&gt;        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;valor_3&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-85"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_3"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-86"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-87"&gt;&lt;/a&gt;        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;valor_4&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-88"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_4&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_4"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-89"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_4&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-90"&gt;&lt;/a&gt;        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;valor_5&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-91"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_5&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_5"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-92"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_5&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-93"&gt;&lt;/a&gt;        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;valor_6&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-94"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_6&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_6"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-95"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_6&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-96"&gt;&lt;/a&gt;        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;valor_7&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-97"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_7&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_7"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-98"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_7&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-99"&gt;&lt;/a&gt;        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;valor_8&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-100"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_8&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_8"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-101"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_8&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-102"&gt;&lt;/a&gt;        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;valor_9&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-103"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_9&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_9"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-104"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_9&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-105"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Se llama al método romper_captcha para obtener el texto correspondiente&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-106"&gt;&lt;/a&gt;        &lt;span class="n"&gt;captcha&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;romper_captcha&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"recorte.png"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-107"&gt;&lt;/a&gt;        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-108"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos la caja de texto donde se escribe el texto del captcha&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-109"&gt;&lt;/a&gt;                &lt;span class="n"&gt;codigo&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"imagen"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-110"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Si el captcha está vacio o no se ha logrado romper se cierra el navegador y se termina la aplicación&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-111"&gt;&lt;/a&gt;                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;captcha&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s2"&gt;""&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-112"&gt;&lt;/a&gt;                        &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-113"&gt;&lt;/a&gt;                        &lt;span class="k"&gt;return&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-114"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Escribimos el texto&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-115"&gt;&lt;/a&gt;                &lt;span class="n"&gt;codigo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;send_keys&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;captcha&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-116"&gt;&lt;/a&gt;        &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-117"&gt;&lt;/a&gt;                &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-118"&gt;&lt;/a&gt;        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-119"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el botón de consulta&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-120"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_consultar&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"bot_consultar"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-121"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Damos click al botón de consulta&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-122"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_consultar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-123"&gt;&lt;/a&gt;        &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-124"&gt;&lt;/a&gt;                &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;"Element is not present"&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-125"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Obtengo el resultado que aparece en el elemento llamado style2&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-126"&gt;&lt;/a&gt;        &lt;span class="n"&gt;resultado&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_class_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"style2"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-127"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Partimos el resultado para obtener el nombre&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-128"&gt;&lt;/a&gt;        &lt;span class="n"&gt;nombre&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;resultado&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-129"&gt;&lt;/a&gt;        &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-130"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;nombre&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-131"&gt;&lt;/a&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-132"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;romper_captcha&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nombre_imagen&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-133"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Abro la imagen&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-134"&gt;&lt;/a&gt;        &lt;span class="n"&gt;img&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nombre_imagen&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-135"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Obtengo un arreglo de píxeles de la imagen&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-136"&gt;&lt;/a&gt;        &lt;span class="n"&gt;pixdata&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-137"&gt;&lt;/a&gt;        &lt;span class="sd"&gt;"""Modifico los píxeles de la imagen de acuerdo al análisis de los&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-138"&gt;&lt;/a&gt;&lt;span class="sd"&gt;        colores de las letras y las lineas que cruzan el texto, pintando de negro los píxeles del&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-139"&gt;&lt;/a&gt;&lt;span class="sd"&gt;        texto y de blanco las lineas"""&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-140"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]):&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-141"&gt;&lt;/a&gt;                &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]):&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-142"&gt;&lt;/a&gt;                        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;pixdata&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;146&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-143"&gt;&lt;/a&gt;                                &lt;span class="n"&gt;pixdata&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-144"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]):&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-145"&gt;&lt;/a&gt;                &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]):&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-146"&gt;&lt;/a&gt;                        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;pixdata&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;     &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-147"&gt;&lt;/a&gt;                                &lt;span class="n"&gt;pixdata&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-148"&gt;&lt;/a&gt;                        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-149"&gt;&lt;/a&gt;                                &lt;span class="n"&gt;pixdata&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-150"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Guardo la imagen modificada&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-151"&gt;&lt;/a&gt;        &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"modificado.jpg"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-152"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Abro la imagen modificado&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-153"&gt;&lt;/a&gt;        &lt;span class="n"&gt;image&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"modificado.jpg"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-154"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Obtenemos el texto de la imagen&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-155"&gt;&lt;/a&gt;        &lt;span class="n"&gt;frase&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pytesseract&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;image_to_string&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-156"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Retornamos el texto eliminado los espacios en blanco entre las palabras y convirtiendolas en mayúsculas&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-157"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;frase&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;' '&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s2"&gt;""&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;upper&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-158"&gt;&lt;/a&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-159"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-160"&gt;&lt;/a&gt;        &lt;span class="n"&gt;dni&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'123456789'&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-161"&gt;&lt;/a&gt;        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;ir_reniec_web&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dni&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-162"&gt;&lt;/a&gt;
&lt;a name="rest_code_45643eb54d144e69bfc710bb93978787-163"&gt;&lt;/a&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Espero que les sea útil.
Saludos.&lt;/p&gt;&lt;/div&gt;</description><category>pillow</category><category>pytesseract</category><category>Python</category><category>Selenium</category><guid>http://pythonpiura.org/posts/2016/05/11/consulta-dni-reniec/</guid><pubDate>Thu, 12 May 2016 02:37:08 GMT</pubDate></item><item><title>Otro Ejemplo de Web Scrapping con Python</title><link>http://pythonpiura.org/posts/2016/05/10/otro-ejemplo-de-web-scrapping-con-python/</link><dc:creator>Comunidad Python Piura</dc:creator><description>&lt;div&gt;&lt;p&gt;En esta oportunidad vamos a compartir con ustedes un nuevo script para
consultar rucs de manera masiva a partir del DNI en la página web de
sunat, esto ha sido un poco mas complejo debido a que la página en
cuestión usa frames, también hemos mejorado un poquito el problema de
los tamaños haciendo el recorte a partir del tamaño de la captura de
pantalla:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# -*- coding: utf-8 -*-&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;webdriver&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium.webdriver.common.by&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;By&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium.webdriver.support.wait&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;WebDriverWait&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium.webdriver.support&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;expected_conditions&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;EC&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-7"&gt;&lt;/a&gt;        &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;Image&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;ImportError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-9"&gt;&lt;/a&gt;        &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PIL&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Image&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-10"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pytesseract&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-11"&gt;&lt;/a&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-12"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;ir_sunat_web&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dni&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-13"&gt;&lt;/a&gt;        &lt;span class="n"&gt;driver&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;webdriver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Firefox&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-14"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Fijamos nuestra página objetivo&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-15"&gt;&lt;/a&gt;        &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"http://ww1.sunat.gob.pe/cl-ti-itmrconsruc/jcrS00Alias"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-16"&gt;&lt;/a&gt;        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-17"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Debido a que la página tiene frames debemos hacer el cambio al frame con nombre "leftFrame"&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-18"&gt;&lt;/a&gt;                &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;switch_to_frame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"leftFrame"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-19"&gt;&lt;/a&gt;        &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-20"&gt;&lt;/a&gt;                &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-21"&gt;&lt;/a&gt;                &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-22"&gt;&lt;/a&gt;        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-23"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos los radio buttons que nos permiten seleccionar el tipo de búsqueda a hacer&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-24"&gt;&lt;/a&gt;                &lt;span class="n"&gt;radios&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_elements_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tQuery"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-25"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Seleccionamos la búsqueda por DNI&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-26"&gt;&lt;/a&gt;                &lt;span class="n"&gt;radios&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-27"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos la caja de texto donde se ingresa el DNI&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-28"&gt;&lt;/a&gt;                &lt;span class="n"&gt;documento&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"search2"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-29"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Escribimos el DNI&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-30"&gt;&lt;/a&gt;                &lt;span class="n"&gt;documento&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;send_keys&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dni&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-31"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Esperamos hasta que el texto esté escrito en la caja de texto del DNI&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-32"&gt;&lt;/a&gt;                &lt;span class="n"&gt;WebDriverWait&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;until&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;EC&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text_to_be_present_in_element_value&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;By&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;NAME&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s2"&gt;"search2"&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;dni&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-33"&gt;&lt;/a&gt;        &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-34"&gt;&lt;/a&gt;                &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-35"&gt;&lt;/a&gt;                &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-36"&gt;&lt;/a&gt;        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-37"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Esperamos hasta que se cargue la imagen con el captcha&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-38"&gt;&lt;/a&gt;                &lt;span class="n"&gt;WebDriverWait&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;until&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;EC&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;presence_of_element_located&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;By&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;NAME&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"imagen"&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-39"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Hacemos la captura de pantalla correspondiente&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-40"&gt;&lt;/a&gt;                &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save_screenshot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"screenshot.jpg"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-41"&gt;&lt;/a&gt;                &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'screenshot.jpg'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-42"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el ancho y el largo de la imagen&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-43"&gt;&lt;/a&gt;                &lt;span class="n"&gt;ancho&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-44"&gt;&lt;/a&gt;                &lt;span class="n"&gt;alto&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-45"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Recortamos la parte del captcha teniendo en cuenta el ancho y el largo de la imagen&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-46"&gt;&lt;/a&gt;                &lt;span class="n"&gt;img_recortada&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;crop&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;ancho&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;1.4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;alto&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;ancho&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;1.25&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;alto&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;6.9&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-47"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Guardamos el recorte&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-48"&gt;&lt;/a&gt;                &lt;span class="n"&gt;img_recortada&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"recorte.jpg"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-49"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el texto del captcha&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-50"&gt;&lt;/a&gt;                &lt;span class="n"&gt;captcha&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pytesseract&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;image_to_string&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img_recortada&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-51"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos la caja de texto donde se escribe el texto del captcha&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-52"&gt;&lt;/a&gt;                &lt;span class="n"&gt;codigo&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"codigo"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-53"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Escribimos el texto&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-54"&gt;&lt;/a&gt;                &lt;span class="n"&gt;codigo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;send_keys&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;captcha&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-55"&gt;&lt;/a&gt;        &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-56"&gt;&lt;/a&gt;                &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-57"&gt;&lt;/a&gt;                &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-58"&gt;&lt;/a&gt;        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-59"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el botón de búsqueda&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-60"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_class_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"form-button"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-61"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Damos click al botón de búsqueda&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-62"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-63"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Cambiamos al frame por defecto&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-64"&gt;&lt;/a&gt;                &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;switch_to_default_content&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-65"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Cambiamos al frame llamado "mainFrame" que contiene la tabla de resultados con un enlace conteniendo el ruc&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-66"&gt;&lt;/a&gt;                &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;switch_to_frame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"mainFrame"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-67"&gt;&lt;/a&gt;        &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-68"&gt;&lt;/a&gt;                &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-69"&gt;&lt;/a&gt;                &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-70"&gt;&lt;/a&gt;        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-71"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Esperamos que se cargue la tabla de resultados&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-72"&gt;&lt;/a&gt;                &lt;span class="n"&gt;WebDriverWait&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;until&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;EC&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;presence_of_element_located&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;By&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CLASS_NAME&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"form-table"&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-73"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el enlace que contiene al RUC&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-74"&gt;&lt;/a&gt;                &lt;span class="n"&gt;enlace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;By&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TAG_NAME&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s2"&gt;"a"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-75"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Le damos click al enlace&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-76"&gt;&lt;/a&gt;                &lt;span class="n"&gt;enlace&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-77"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Ahora si tenemos una tabla que contiene el detalle de los resultados del RUC consultado&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-78"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos todas las filas&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-79"&gt;&lt;/a&gt;                &lt;span class="n"&gt;trs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_elements&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;By&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TAG_NAME&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"tr"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-80"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos las celdas de la primera fila&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-81"&gt;&lt;/a&gt;                &lt;span class="n"&gt;tds&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;trs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_elements&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;By&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TAG_NAME&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"td"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-82"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#A la segunda celda la partimos ya que tiene el ruc y la razón social separados por un guión&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-83"&gt;&lt;/a&gt;                &lt;span class="n"&gt;primera_linea&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tds&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'-'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-84"&gt;&lt;/a&gt;                &lt;span class="n"&gt;ruc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;primera_linea&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-85"&gt;&lt;/a&gt;                &lt;span class="n"&gt;razon_social&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;primera_linea&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-86"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos la segunda linea que tiene el tipo de contribuyente&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-87"&gt;&lt;/a&gt;                &lt;span class="n"&gt;tds&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;trs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_elements&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;By&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TAG_NAME&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"td"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-88"&gt;&lt;/a&gt;                &lt;span class="n"&gt;tipo_contribuyente&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tds&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-89"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos la dirección&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-90"&gt;&lt;/a&gt;                &lt;span class="n"&gt;tds&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;trs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_elements&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;By&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TAG_NAME&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"td"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-91"&gt;&lt;/a&gt;                &lt;span class="n"&gt;direccion&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tds&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-92"&gt;&lt;/a&gt;        &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-93"&gt;&lt;/a&gt;                &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-94"&gt;&lt;/a&gt;                &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-95"&gt;&lt;/a&gt;        &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-96"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Devolvemos una lista con los resultados.&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-97"&gt;&lt;/a&gt;        &lt;span class="n"&gt;datos&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ruc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;razon_social&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tipo_contribuyente&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;direccion&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-98"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;datos&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-99"&gt;&lt;/a&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-100"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-101"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Ingresar DNI&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-102"&gt;&lt;/a&gt;        &lt;span class="n"&gt;dni&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'12345678'&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-103"&gt;&lt;/a&gt;        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;ir_sunat_web&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dni&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-104"&gt;&lt;/a&gt;
&lt;a name="rest_code_93c304482d514a3abced91f0a3291753-105"&gt;&lt;/a&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;iframe width="459" height="344" src="https://www.youtube.com/embed/ijICFYtAuDE?feature=oembed" frameborder="0" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;Esperamos que les sea útil.
Saludos.&lt;/p&gt;&lt;/div&gt;</description><category>Django</category><category>pytesseract</category><category>Selenium</category><guid>http://pythonpiura.org/posts/2016/05/10/otro-ejemplo-de-web-scrapping-con-python/</guid><pubDate>Wed, 11 May 2016 04:35:39 GMT</pubDate></item><item><title>Web Scrapping con Python y Selenium</title><link>http://pythonpiura.org/posts/2016/05/07/web-scrapping-con-python-y-selenium/</link><dc:creator>Comunidad Python Piura</dc:creator><description>&lt;div&gt;&lt;p&gt;El día de hoy tuvimos el agrado de ser invitados por el &lt;a class="reference external" href="https://cideuel.wordpress.com/"&gt;Círculo UEL&lt;/a&gt;
a dar una charla en el marco del FLISOL 2016 en la Universidad Los
Ángeles de Chimbote Sede Piura y el tema fue Web Scrapping con Python
y Selenium, hicimos algunos ejemplos muy interesantes y nos encantó la
acogida del público y el interés suscitado, vamos a compartir los
artículos que usamos:&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://pythonpiura.wordpress.com/2014/09/18/selenium-con-python/"&gt;Selenium con Python&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://pythonpiura.wordpress.com/2016/01/26/romper-captchas-con-pytesseract-y-selenium/"&gt;Romper Captchas con Pytesseract y Selenium&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Las diapositivas:&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="http://pythonpiura.org/recursos/charlapythonflisol2016.pdf"&gt;Descargar&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;El script que fue la estrella de la mañana:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# -*- coding: utf-8 -*-&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;webdriver&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium.webdriver.common.by&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;By&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium.webdriver.support.wait&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;WebDriverWait&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium.webdriver.support&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;expected_conditions&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;EC&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-6"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-7"&gt;&lt;/a&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-8"&gt;&lt;/a&gt;&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-9"&gt;&lt;/a&gt;        &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;Image&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-10"&gt;&lt;/a&gt;&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;ImportError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-11"&gt;&lt;/a&gt;        &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PIL&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Image&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-12"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pytesseract&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-13"&gt;&lt;/a&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-14"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;decodifica_campo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;campo&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-15"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;u"&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;campo&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-16"&gt;&lt;/a&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-17"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;ir_sunat_web&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ruta&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-18"&gt;&lt;/a&gt;        &lt;span class="n"&gt;fp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;webdriver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;FirefoxProfile&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-19"&gt;&lt;/a&gt;        &lt;span class="n"&gt;fp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_preference&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"browser.download.manager.showWhenStarting"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-20"&gt;&lt;/a&gt;        &lt;span class="n"&gt;fp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_preference&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"browser.download.manager.closeWhenDone"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-21"&gt;&lt;/a&gt;        &lt;span class="n"&gt;fp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_preference&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"browser.download.manager.showAlertOnComplete"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-22"&gt;&lt;/a&gt;        &lt;span class="n"&gt;fp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_preference&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"browser.helperApps.neverAsk.saveToDisk"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"application/zip"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-23"&gt;&lt;/a&gt;        &lt;span class="n"&gt;driver&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;webdriver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Firefox&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-24"&gt;&lt;/a&gt;        &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"http://www.sunat.gob.pe/cl-ti-itmrconsmulruc/jrmS00Alias"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-25"&gt;&lt;/a&gt;        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-26"&gt;&lt;/a&gt;                &lt;span class="n"&gt;WebDriverWait&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;until&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;EC&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;presence_of_element_located&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;By&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;NAME&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"imagen"&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-27"&gt;&lt;/a&gt;        &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-28"&gt;&lt;/a&gt;                &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;"No carga imagen"&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-29"&gt;&lt;/a&gt;        &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save_screenshot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"screenshot.png"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-30"&gt;&lt;/a&gt;        &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'screenshot.png'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-31"&gt;&lt;/a&gt;        &lt;span class="n"&gt;img_recortada&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;crop&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;700&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;309&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;800&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;361&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-32"&gt;&lt;/a&gt;        &lt;span class="n"&gt;img_recortada&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"recorte.png"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-33"&gt;&lt;/a&gt;        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-34"&gt;&lt;/a&gt;                &lt;span class="n"&gt;captcha&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pytesseract&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;image_to_string&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img_recortada&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-35"&gt;&lt;/a&gt;                &lt;span class="n"&gt;codigo&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"codigoA"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-36"&gt;&lt;/a&gt;                &lt;span class="n"&gt;codigo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;send_keys&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;captcha&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-37"&gt;&lt;/a&gt;        &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-38"&gt;&lt;/a&gt;                &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-39"&gt;&lt;/a&gt;        &lt;span class="n"&gt;archivo&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"archivo"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-40"&gt;&lt;/a&gt;        &lt;span class="n"&gt;archivo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;send_keys&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ruta&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-41"&gt;&lt;/a&gt;        &lt;span class="n"&gt;form&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"frmConsMulRucArchivo"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-42"&gt;&lt;/a&gt;        &lt;span class="n"&gt;botones&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_elements_by_class_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"form-button"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-43"&gt;&lt;/a&gt;        &lt;span class="n"&gt;botones&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-44"&gt;&lt;/a&gt;        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-45"&gt;&lt;/a&gt;                &lt;span class="n"&gt;WebDriverWait&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;until&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;EC&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;presence_of_all_elements_located&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;By&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CLASS_NAME&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"form-table"&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-46"&gt;&lt;/a&gt;                &lt;span class="n"&gt;enlace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;By&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TAG_NAME&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s2"&gt;"a"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-47"&gt;&lt;/a&gt;                &lt;span class="n"&gt;enlace&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-48"&gt;&lt;/a&gt;        &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-49"&gt;&lt;/a&gt;                &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;"Element is not present"&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-50"&gt;&lt;/a&gt;                &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-51"&gt;&lt;/a&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-52"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-53"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ruta&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;"/home/usuario/carpeta"&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-54"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ruta_archivo&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ruta&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s2"&gt;"rucs.zip"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-55"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ir_sunat_web&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ruta_archivo&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-56"&gt;&lt;/a&gt;
&lt;a name="rest_code_4dfd84248b5a487c8a54dc7e7b0a2a9d-57"&gt;&lt;/a&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Así como también un vídeo de su funcionamiento.&lt;/p&gt;
&lt;div class="youtube-video"&gt;
&lt;iframe width="425" height="344" src="https://www.youtube.com/embed/mUaVFYTlibM?rel=0&amp;amp;hd=1&amp;amp;wmode=transparent"&gt;&lt;/iframe&gt;
&lt;/div&gt;&lt;p&gt;Saludos y muchas gracias.&lt;/p&gt;&lt;/div&gt;</description><category>pillow</category><category>pytesseract</category><category>Python</category><category>Selenium</category><guid>http://pythonpiura.org/posts/2016/05/07/web-scrapping-con-python-y-selenium/</guid><pubDate>Sun, 08 May 2016 01:58:06 GMT</pubDate></item></channel></rss>