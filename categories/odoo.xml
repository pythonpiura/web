<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>Python Piura (Publicaciones sobre odoo)</title><link>http://pythonpiura.org/</link><description></description><atom:link href="http://pythonpiura.org/categories/odoo.xml" type="application/rss+xml" rel="self"></atom:link><language>es</language><lastBuildDate>Fri, 20 Jan 2017 05:17:09 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Configurando un Proxy Inverso para Odoo 10</title><link>http://pythonpiura.org/posts/configurando-un-proxy-inverso-para-odoo-10/</link><dc:creator>Comunidad Python Piura</dc:creator><description>&lt;div&gt;&lt;p&gt;Teniendo en cuenta la configuración realizada en nuestro anterior artículo &lt;a class="reference external" href="http://pythonpiura.org/posts/instalacion-odoo-10-en-produccion/"&gt;Instalación de Odoo 10 en Producción&lt;/a&gt;
en esta oportunidad, vamos a configurar un proxy inverso para poder acceder a nuestro odoo mediante el puerto 80, en otro artículo haremos lo mismo para el protocolo https usando el puerto 443, debemos recalcar que en esta oportunidad hemos utilizado como guía el libro "Odoo 10 Development Essentials" de Daniel Reis, entonces manos a la obra.&lt;/p&gt;
&lt;p&gt;Odoo puede servir páginas web por si mismo, pero se recomienda tener un proxy Inverso en frente. Un proxy inverso actúa como un intermediario que gestiona el tráfico entre los clientes que envían solicitudes y el servidor Odoo que les responde. El uso de un proxy inverso tiene varios beneficios.&lt;/p&gt;
&lt;p&gt;A nivel de seguridad:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Manejar (y hacer cumplir) los protocolos HTTPS para cifrar el tráfico&lt;/li&gt;
&lt;li&gt;Ocultar las características de la red interna&lt;/li&gt;
&lt;li&gt;Actuar como un cortafuegos que limita las URL aceptadas para el procesamiento&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;A nivel de rendimiento:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Caché de contenido estático, reduciendo así la carga en los servidores Odoo&lt;/li&gt;
&lt;li&gt;Comprimir contenido para acelerar los tiempos de carga&lt;/li&gt;
&lt;li&gt;Actuar como un equilibrador de carga, distribuyendola entre varios servidores.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Apache es una opción popular para usar como un proxy inverso, pero en esta oportunidad usaremos Nginx, Nginx es una alternativa reciente con buenas características técnicas y fácil de configurar.&lt;/p&gt;
&lt;div class="section" id="configurando-nginx-como-proxy-inverso"&gt;
&lt;h2&gt;Configurando Nginx como Proxy Inverso&lt;/h2&gt;
&lt;p&gt;Nginx, escucha en los puertos HTTP predeterminados(80), por lo que debemos asegurarnos que ninguna otra aplicación esté usando estos puertos, probaremos esto con la herramienta curl:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_548d09f6f6b5414fab6d02ef20edec54-1"&gt;&lt;/a&gt;apt-get install curl
&lt;a name="rest_code_548d09f6f6b5414fab6d02ef20edec54-2"&gt;&lt;/a&gt;curl http://localhost
&lt;/pre&gt;&lt;p&gt;Si nos sale un mensaje como el siguiente entonces el puerto está libre:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_37128db7caa040c6b6cb81fd3b8e586a-1"&gt;&lt;/a&gt;curl: &lt;span class="o"&gt;(&lt;/span&gt;7&lt;span class="o"&gt;)&lt;/span&gt; Failed to connect to localhost port 80: Conexión rehusada
&lt;/pre&gt;&lt;p&gt;Ahora procedemos a instalar nginx:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_8ece38c9019d4d098bb0389df87e4130-1"&gt;&lt;/a&gt;apt-get install nginx
&lt;/pre&gt;&lt;p&gt;Para confirmar que está funcionando correctamente debemos ver una página de bienvenida cuando visitemos el servidor con un navegador web o usando curl:&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="http://IP_SERVER"&gt;http://IP_SERVER&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Los archivos de configuración de Nginx siguen el mismo enfoque que Apache se almacenan en:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_27962c11c379475db20307cab7bad630-1"&gt;&lt;/a&gt;/etc/nginx/available-sites/
&lt;/pre&gt;&lt;p&gt;Y se activan añadiendo un enlace simbólico en:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_6abe33fa794246cd9a53fb77ddab5336-1"&gt;&lt;/a&gt;/etc/nginx/enabled-sites
&lt;/pre&gt;&lt;p&gt;También debemos desactivar la configuración predeterminada proporcionada por la instalación de Nginx, borrando el archivo default:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_0ace42ed1b0f461197d653e8426f5c3d-1"&gt;&lt;/a&gt;rm /etc/nginx/sites-enabled/default
&lt;/pre&gt;&lt;p&gt;Ahora creamos el archivo para odoo:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_5a8e0ec772d140e3ab6a048ea8f58226-1"&gt;&lt;/a&gt;nano /etc/nginx/sites-available/odoo
&lt;/pre&gt;&lt;p&gt;y le agregamos el siguiente contenido:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_22cebd8fa4c04f5e94d5881f823e6501-1"&gt;&lt;/a&gt;upstream backend-odoo&lt;span class="o"&gt;{&lt;/span&gt;
&lt;a name="rest_code_22cebd8fa4c04f5e94d5881f823e6501-2"&gt;&lt;/a&gt;        server 127.0.0.1:8069&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_22cebd8fa4c04f5e94d5881f823e6501-3"&gt;&lt;/a&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;a name="rest_code_22cebd8fa4c04f5e94d5881f823e6501-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_22cebd8fa4c04f5e94d5881f823e6501-5"&gt;&lt;/a&gt;server&lt;span class="o"&gt;{&lt;/span&gt;
&lt;a name="rest_code_22cebd8fa4c04f5e94d5881f823e6501-6"&gt;&lt;/a&gt;        location / &lt;span class="o"&gt;{&lt;/span&gt;
&lt;a name="rest_code_22cebd8fa4c04f5e94d5881f823e6501-7"&gt;&lt;/a&gt;                proxy_pass http://backend-odoo&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_22cebd8fa4c04f5e94d5881f823e6501-8"&gt;&lt;/a&gt;        &lt;span class="o"&gt;}&lt;/span&gt;
&lt;a name="rest_code_22cebd8fa4c04f5e94d5881f823e6501-9"&gt;&lt;/a&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Primero, agregamos los upstreams, y los servidores backend Nginx redirigirán el tráfico al servidor Odoo en que está escuchando en el puerto 8069&lt;/p&gt;
&lt;p&gt;Añadimos el enlace simbólico:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_469d05f099664ba2b39788f841010472-1"&gt;&lt;/a&gt;ln -s /etc/nginx/sites-available/odoo /etc/nginx/sites-enabled/odoo
&lt;/pre&gt;&lt;p&gt;Para testear si la configuración es correcta hacemos lo siguiente:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_5f54f9f13b684efb816a948e45618786-1"&gt;&lt;/a&gt;nginx -t
&lt;/pre&gt;&lt;p&gt;Si hay errores revisar si hemos escrito correctamente la configuración en el archivo odoo.&lt;/p&gt;
&lt;p&gt;Recargamos nginx:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_4c33912bd6cd49fa9e6fee3f47f6e52c-1"&gt;&lt;/a&gt;/etc/init.d/nginx reload
&lt;/pre&gt;&lt;p&gt;Y visitamos nuestro servidor a través del navegador web:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_68fa3a84570d4971bccb3851832c99ac-1"&gt;&lt;/a&gt;http://IP_SERVER
&lt;/pre&gt;&lt;p&gt;Este nos redirigirá automáticamente a Odoo, eso es todo por hoy.&lt;/p&gt;
&lt;p&gt;Saludos.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>odoo</category><guid>http://pythonpiura.org/posts/configurando-un-proxy-inverso-para-odoo-10/</guid><pubDate>Thu, 19 Jan 2017 16:09:29 GMT</pubDate></item><item><title>Instalación de Odoo 10 en Producción</title><link>http://pythonpiura.org/posts/instalacion-odoo-10-en-produccion/</link><dc:creator>Comunidad Python Piura</dc:creator><description>&lt;div&gt;&lt;p&gt;Ultimamente estamos trabajando con Odoo 10 y queremos compartir con ustedes la instalación de este genial software sobre un servidor Debian Jessie listo para ponerlo en producción, este es el primer artículo sobre el tema, el segundo estará siendo lanzado en los proximos días. Para escribir este artículo hemos tenido en cuenta los libros "Odoo Development Cookbook" y "Odoo 10      Development     Essentials"&lt;/p&gt;
&lt;p&gt;Lo primero que debemos hacer es instalar Debian, los pasos para esto no los vamos a tener en cuenta en este artículo, ya que hay muy buenos tutoriales en la red.&lt;/p&gt;
&lt;p&gt;Una vez instalado Debian es ingresar como root y actualizar el software:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_c3e8635593be47d08911cb455f696847-1"&gt;&lt;/a&gt;apt update &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt upgrade
&lt;/pre&gt;&lt;p&gt;Ahora instalamos los paquetes necesarios que nos permitiran el correcto funcionamiento de Odoo&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_c4790216048249b2986b8739d9133c2a-1"&gt;&lt;/a&gt;apt-get install git python2.7 postgresql nano python-virtualenv &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_c4790216048249b2986b8739d9133c2a-2"&gt;&lt;/a&gt;gcc python2.7-dev libxml2-dev libxslt1-dev &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_c4790216048249b2986b8739d9133c2a-3"&gt;&lt;/a&gt;libevent-dev libsasl2-dev libldap2-dev libpq-dev &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_c4790216048249b2986b8739d9133c2a-4"&gt;&lt;/a&gt;libpng12-dev libjpeg-dev node-less node-clean-css &lt;span class="se"&gt;\&lt;/span&gt;
&lt;a name="rest_code_c4790216048249b2986b8739d9133c2a-5"&gt;&lt;/a&gt;xfonts-75dpi xfonts-base
&lt;/pre&gt;&lt;p&gt;En odoo los reportes se generan usando la librería wkhtmltox, por lo que es necesario primero descargarla:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_17b3116234a04855b06c3cd41f0b6031-1"&gt;&lt;/a&gt;wget http://nightly.odoo.com/extra/wkhtmltox-0.12.1.2_linux-jessie-amd64.deb
&lt;/pre&gt;&lt;p&gt;Y luego instalarla:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_f172eee6ea6e425b9b2adc8be3c1f8c2-1"&gt;&lt;/a&gt;dpkg -i wkhtmltox-0.12.1.2_linux-jessie-amd64.deb
&lt;/pre&gt;&lt;p&gt;Creamos el usuario odoo:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_6ce6d051cd39411cbdb143e5041844cf-1"&gt;&lt;/a&gt;adduser odoo
&lt;/pre&gt;&lt;p&gt;Instalamos sudo para poder realizar algunas operaciones necesarias con permisos de superusuario:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_c92aad3080474a5196cd72baa227c001-1"&gt;&lt;/a&gt;apt install sudo
&lt;/pre&gt;&lt;p&gt;Creamos el usuario de base de datos odoo, esto lo hacemos con el usuario postgres:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_f82b125484f349dbaf16681b738d2730-1"&gt;&lt;/a&gt;sudo -u postgres createuser odoo
&lt;/pre&gt;&lt;p&gt;Si nos aparece el sguiente mensaje:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_d679440358d842da8f92742cef731742-1"&gt;&lt;/a&gt;could not change directory to &lt;span class="s2"&gt;"/root"&lt;/span&gt;: Permiso denegado
&lt;/pre&gt;&lt;p&gt;No debemos preocuparnos y procedemos a crear la base de datos odoo-project y la asignamos al usuario odoo:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_d988dcba70ba483bb5f6e1c8d94caa66-1"&gt;&lt;/a&gt;sudo -u postgres createdb -O odoo odoo-project
&lt;/pre&gt;&lt;p&gt;Ahora nos cambiamos al usuario odoo:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_c733f364ae73473d9c0a40233db5d252-1"&gt;&lt;/a&gt;su odoo
&lt;/pre&gt;&lt;p&gt;Creamos la carpeta odoo-prod donde vamos a guardar todos los archivos y carpetas necesarias de odoo:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_898f46e753fc4e9392e59bf28588aaa1-1"&gt;&lt;/a&gt;mkdir ~/odoo-prod
&lt;/pre&gt;&lt;p&gt;Fijémonos que antes del nombre de la carpeta tenemos los caracteres     "~/", con esto indicamos que no importa la carpeta donde estemos situados actualmente, siempre la creará en el home del usuario en sesión.&lt;/p&gt;
&lt;p&gt;Ahora ingresamos a la carpeta creada:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_a87bebd6b7b0407c976d216d318b00a4-1"&gt;&lt;/a&gt;&lt;span class="nb"&gt;cd&lt;/span&gt; ~/odoo-prod
&lt;/pre&gt;&lt;p&gt;Y dentro de esta creamos las carpetas project y src dentro de project:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_8bdd488ffc3f49eebf7a4e9b688d07ad-1"&gt;&lt;/a&gt;mkdir -p project/src
&lt;/pre&gt;&lt;p&gt;Ingresamos a la carpeta src donde guardaremos el código de odoo:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_e38dd8f242df43b1a77121b306812dd0-1"&gt;&lt;/a&gt;&lt;span class="nb"&gt;cd&lt;/span&gt; project/src
&lt;/pre&gt;&lt;p&gt;Ahora clonamos desde github el código fuente de odoo:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_6b8fe420c8824e58b4c69bf7941ad3cd-1"&gt;&lt;/a&gt;git clone -b 10.0 --depth&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; https://github.com/odoo/odoo.git odoo
&lt;/pre&gt;&lt;p&gt;Observemos el parámetro --depth=1, este parámetro ignora la historia de los cambios y recupera sólo la última revisión de código, haciendo la descarga mucho más rápida.&lt;/p&gt;
&lt;p&gt;Creamos un entorno virtual para trabajar con Odoo:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_848904cbc4304405aa2af3dfa270bbbd-1"&gt;&lt;/a&gt;virtualenv ~/env-odoo-10.0
&lt;/pre&gt;&lt;p&gt;Activamos el entorno virtual:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_f01c70166a2640bcb94420c83d64d257-1"&gt;&lt;/a&gt;&lt;span class="nb"&gt;source&lt;/span&gt; ~/env-odoo-10.0/bin/activate
&lt;/pre&gt;&lt;p&gt;Instalamos las dependencias necesarias para odoo 10:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_2c46610228d14f54a7197ee4636ed6b2-1"&gt;&lt;/a&gt;pip install -r odoo/requirements.txt
&lt;/pre&gt;&lt;p&gt;Hasta aquí ya podemos correr odoo sin ningún problema usando el script odoo-bin ubicado en el código fuente de odoo, pero continuaremos haciendo algunos pasos adicionales para obtener una mejor performance.&lt;/p&gt;
&lt;p&gt;Procedemos a crear la carpeta bin dentro de project:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_03f94c8b070248148d506ba090a5268e-1"&gt;&lt;/a&gt;mkdir ~/odoo-prod/project/bin
&lt;/pre&gt;&lt;p&gt;Ahora vamos a generar nuestro archivo de configuración de odoo, llamado production.conf, utilizando la siguiente orden:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_ff5a5e6bab8347e793ec734725bd2b96-1"&gt;&lt;/a&gt;~/odoo-prod/project/src/odoo/odoo-bin --save --config ~/odoo-prod/project/production.conf --stop-after-init
&lt;/pre&gt;&lt;p&gt;Los parámetros --save y --config nos permiten crear y guardar el archivo de configuración en la ruta indicada, con el parámetro --stop-after-init paramos la ejecución de odoo y volvemos a la terminal.&lt;/p&gt;
&lt;p&gt;Ahora vamos a crear el archivo que arrancará nuestro odoo, le vamos a denominar start-odoo y va a estar ubicado en la carpeta bin:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_a5538bffebad461685ffbba91db8dbbf-1"&gt;&lt;/a&gt;nano ~/odoo-prod/project/bin/start-odoo
&lt;/pre&gt;&lt;p&gt;Este archivo es un script que contendrá lo siguiente:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_d49fb3417edf458c9fc194a7f248881b-1"&gt;&lt;/a&gt;&lt;span class="ch"&gt;#! /bin/sh&lt;/span&gt;
&lt;a name="rest_code_d49fb3417edf458c9fc194a7f248881b-2"&gt;&lt;/a&gt;&lt;span class="nv"&gt;PYTHON&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;~odoo/env-odoo-10.0/bin/python
&lt;a name="rest_code_d49fb3417edf458c9fc194a7f248881b-3"&gt;&lt;/a&gt;&lt;span class="nv"&gt;ODOO&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;~odoo/odoo-prod/project/src/odoo/odoo-bin
&lt;a name="rest_code_d49fb3417edf458c9fc194a7f248881b-4"&gt;&lt;/a&gt;&lt;span class="nv"&gt;CONF&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;~odoo/odoo-prod/project/production.conf
&lt;a name="rest_code_d49fb3417edf458c9fc194a7f248881b-5"&gt;&lt;/a&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;PYTHON&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt; &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;ODOO&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt; -c &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;CONF&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;El detalle de este archivo se explica de la siguiente manera:&lt;/p&gt;
&lt;p&gt;-Tenemos el intérprete del entorno virtual, con esto nos despreocupamos de estar activando el entorno virtual cada vez que querramos arrancar el odoo.&lt;/p&gt;
&lt;p&gt;-El script que viene en el código de odoo y que inicia la aplicación, se llama odoo-bin.&lt;/p&gt;
&lt;p&gt;-El archivo de configuración de odoo, llamado production.conf&lt;/p&gt;
&lt;p&gt;-Y finalmente el llamado a la orden que arranca odoo utilizando los parámetros contenidos en el archivo de configuración.&lt;/p&gt;
&lt;p&gt;Le damos permisos de ejecución al script start-odoo&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_940affa219b74bc49f022c4e51bd81cb-1"&gt;&lt;/a&gt;chmod +x ~/odoo-prod/project/bin/start-odoo
&lt;/pre&gt;&lt;p&gt;Para probarlo arranquemos el script:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_0c03be2b9fc6493b9c6620ebbf252d80-1"&gt;&lt;/a&gt;~/odoo-prod/project/bin/start-odoo
&lt;/pre&gt;&lt;p&gt;Y probemos que funciona correctamente poniendo la IP del servidor y el puerto 8069:&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="http://IP_SERVER_ODOO:8069"&gt;http://IP_SERVER_ODOO:8069&lt;/a&gt;&lt;/p&gt;
&lt;div class="section" id="tuneando-postgresql"&gt;
&lt;h2&gt;Tuneando PostgreSQL&lt;/h2&gt;
&lt;p&gt;La configuración predeterminada de PostgreSQL es generalmente muy conservadora y tiene la intención de evitar que el servidor de base de datos acapare todos los recursos del sistema. En servidores de producción, se pueden aumentar algunos parámetros en el archivo postgresql.conf para obtener un mejor rendimiento.&lt;/p&gt;
&lt;p&gt;Vamos a editar el archivo postgresql.conf:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_b00f16c3ca9c4597a3212329eacb3e9f-1"&gt;&lt;/a&gt;nano /etc/postgresql/9.4/main/postgresql.conf
&lt;/pre&gt;&lt;p&gt;Estas son algunas de las opciones que utilizaremos:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_d53245d47ac94cc499b21754a5edd17a-1"&gt;&lt;/a&gt;&lt;span class="nv"&gt;max_connections&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 100
&lt;a name="rest_code_d53245d47ac94cc499b21754a5edd17a-2"&gt;&lt;/a&gt;&lt;span class="nv"&gt;shared_buffers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 256MB
&lt;a name="rest_code_d53245d47ac94cc499b21754a5edd17a-3"&gt;&lt;/a&gt;&lt;span class="nv"&gt;effective_cache_size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 768MB
&lt;a name="rest_code_d53245d47ac94cc499b21754a5edd17a-4"&gt;&lt;/a&gt;&lt;span class="nv"&gt;work_mem&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 10MB
&lt;a name="rest_code_d53245d47ac94cc499b21754a5edd17a-5"&gt;&lt;/a&gt;&lt;span class="nv"&gt;maintenance_work_mem&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 64MB
&lt;a name="rest_code_d53245d47ac94cc499b21754a5edd17a-6"&gt;&lt;/a&gt;&lt;span class="nv"&gt;checkpoint_segments&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 16
&lt;a name="rest_code_d53245d47ac94cc499b21754a5edd17a-7"&gt;&lt;/a&gt;&lt;span class="nv"&gt;wal_buffers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 8MB
&lt;a name="rest_code_d53245d47ac94cc499b21754a5edd17a-8"&gt;&lt;/a&gt;&lt;span class="nv"&gt;checkpoint_completion_target&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 0.9
&lt;/pre&gt;&lt;p&gt;Para modificar el archivo procedemos a buscar cada uno de los parámetros y lo editamos o lo descomentamos según sea el caso.&lt;/p&gt;
&lt;p&gt;Ahora reiniciamos el servicio de base de datos:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_411ebc0963024518bd4657b0c9b666bb-1"&gt;&lt;/a&gt;service postgresql restart
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="editando-archivo-de-configuracion-de-odoo"&gt;
&lt;h2&gt;Editando Archivo de Configuración de Odoo&lt;/h2&gt;
&lt;p&gt;Ahora vamos a editar el archivo production.conf para modificar los parámetros necesarios para obtener un mejor rendimiento:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_c5c2c113d56348e39378f55390fb9150-1"&gt;&lt;/a&gt;nano ~/odoo-prod/project/production.conf
&lt;/pre&gt;&lt;p&gt;Los parámetros a modificar serán los siguientes:&lt;/p&gt;
&lt;p&gt;Cambio del directorio de datos:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_9b13eaca35ba494c95aa9a388a5d027a-1"&gt;&lt;/a&gt;&lt;span class="nv"&gt;data_dir&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; /home/odoo/odoo-prod/project/data
&lt;/pre&gt;&lt;p&gt;Cambio del log del servidor:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_d1d01501412f448eb4fa0b21903c4b84-1"&gt;&lt;/a&gt;&lt;span class="nv"&gt;logfile&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; /home/odoo/odoo-prod/project/logs/odoo.log
&lt;/pre&gt;&lt;p&gt;Configuración de la rotación del log, esto permite la rotación de registros. Esto hará que Odoo configure el módulo de registro para archivar los registros del servidor diariamente y mantener los registros antiguos durante 30 días. Esto es útil en servidores de producción para evitar registros que eventualmente consumen todo el espacio disponible en el disco.:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_d14b8d3e79d74432b56d6254629e3e48-1"&gt;&lt;/a&gt;&lt;span class="nv"&gt;logrotate&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; True
&lt;/pre&gt;&lt;p&gt;Configuración de los manejadores de login, esto configura el nivel de registro. La configuración propuesta es muy conservadora y sólo registrará mensajes con al menos el nivel WARNING, excepto werkzeug (CRITICAL) y openerp.service.server (INFO):&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_24892e64413c4eebb0f37057f3bc92e9-1"&gt;&lt;/a&gt;&lt;span class="nv"&gt;log_level&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; warn
&lt;a name="rest_code_24892e64413c4eebb0f37057f3bc92e9-2"&gt;&lt;/a&gt;&lt;span class="nv"&gt;log_handler&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; :WARNING,werkzeug:CRITICAL,openerp.service.server:INFO
&lt;/pre&gt;&lt;p&gt;Adaptación de los parámetros de conexión, esto funcionará si está ejecutando el servidor de base de datos PostgreSQL localmente y lo ha configurado como se explicó en anteriormente. Si se está ejecutando PostgreSQL en un servidor diferente, se tendrá que reemplazar los valores False con la configuración de conexión adecuada para su instancia de base de datos:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_2c3085096ae74e1db12f24d4cd235afd-1"&gt;&lt;/a&gt;&lt;span class="nv"&gt;db_host&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; False
&lt;a name="rest_code_2c3085096ae74e1db12f24d4cd235afd-2"&gt;&lt;/a&gt;&lt;span class="nv"&gt;db_maxconn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 64
&lt;a name="rest_code_2c3085096ae74e1db12f24d4cd235afd-3"&gt;&lt;/a&gt;&lt;span class="nv"&gt;db_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; odoo-project
&lt;a name="rest_code_2c3085096ae74e1db12f24d4cd235afd-4"&gt;&lt;/a&gt;&lt;span class="nv"&gt;db_password&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; False
&lt;a name="rest_code_2c3085096ae74e1db12f24d4cd235afd-5"&gt;&lt;/a&gt;&lt;span class="nv"&gt;db_port&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; False
&lt;a name="rest_code_2c3085096ae74e1db12f24d4cd235afd-6"&gt;&lt;/a&gt;&lt;span class="nv"&gt;db_template&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; template1
&lt;a name="rest_code_2c3085096ae74e1db12f24d4cd235afd-7"&gt;&lt;/a&gt;&lt;span class="nv"&gt;db_user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; False
&lt;/pre&gt;&lt;p&gt;Configuración del filtro de bases de datos y del listado de bases de datos, esto restringe las bases de datos disponibles para la instancia configurando un filtro de base de datos.
Se desactiva el listado de las base de datos, esto no es estrictamente necesario dado que la expresión regular que establecemos en dbfilter sólo puede coincidir con una base de datos única. Sin embargo esto se hace para evitar mostrar la lista de bases de datos y que los usuarios se conecten a la base de datos incorrecta:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_675563aecae24c5abfa4d8c329b40e0e-1"&gt;&lt;/a&gt;&lt;span class="nv"&gt;dbfilter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; odoo-project$
&lt;a name="rest_code_675563aecae24c5abfa4d8c329b40e0e-2"&gt;&lt;/a&gt;&lt;span class="nv"&gt;list_db&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; False
&lt;/pre&gt;&lt;p&gt;Cambio del master password, la contraseña maestra se utiliza para la administración de la base de datos a través de la interfaz de usuario, y algunos addons de la comunidad también lo utilizan para añadir seguridad adicional antes de realizar acciones que pueden conducir a la pérdida de datos.:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_b0be5333e81b41dc8d6c4ebff1fe7bf4-1"&gt;&lt;/a&gt;&lt;span class="nv"&gt;admin_password&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; mypassword
&lt;/pre&gt;&lt;p&gt;Configuración de los workers, Odoo creará una serie de procesos de trabajo (en este ejemplo, 4) para manejar las solicitudes HTTP. Esto tiene varias ventajas sobre la configuración por defecto en la cual el manejo de la petición se realiza en hilos separados:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_ccdeefee11d745e090cc819650db078c-1"&gt;&lt;/a&gt;&lt;span class="nv"&gt;workers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 4
&lt;a name="rest_code_ccdeefee11d745e090cc819650db078c-2"&gt;&lt;/a&gt;&lt;span class="nv"&gt;limit_memory_hard&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;4294967296&lt;/span&gt; &lt;span class="c1"&gt;# 4 GB&lt;/span&gt;
&lt;a name="rest_code_ccdeefee11d745e090cc819650db078c-3"&gt;&lt;/a&gt;&lt;span class="nv"&gt;limit_memory_soft&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;671088640&lt;/span&gt; &lt;span class="c1"&gt;# 640MB&lt;/span&gt;
&lt;a name="rest_code_ccdeefee11d745e090cc819650db078c-4"&gt;&lt;/a&gt;&lt;span class="nv"&gt;limit_request&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 8192
&lt;a name="rest_code_ccdeefee11d745e090cc819650db078c-5"&gt;&lt;/a&gt;&lt;span class="nv"&gt;limit_time_cpu&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 120
&lt;a name="rest_code_ccdeefee11d745e090cc819650db078c-6"&gt;&lt;/a&gt;&lt;span class="nv"&gt;limit_time_real&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 300
&lt;/pre&gt;&lt;p&gt;Si queremos que el sistema cargue datos de prueba debemos mantener el parámetro without_demo en False y si queremos lo contrario lo ponemos a True:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_c94436cda8c44d4094866fc52291e6ea-1"&gt;&lt;/a&gt;&lt;span class="nv"&gt;without_demo&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; False
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="arranque-automatico"&gt;
&lt;h2&gt;Arranque Automático&lt;/h2&gt;
&lt;p&gt;Ahora vamos a configurar systemd para iniciar Odoo automáticamente.&lt;/p&gt;
&lt;p&gt;Si aún seguimos logueados con el usuario odoo, debemos salir y regresar a trabajar con el usuario root:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_35c9b4bb106c4355b2099cff6d4be66f-1"&gt;&lt;/a&gt;&lt;span class="nb"&gt;exit&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Creamos el archivo llamado odoo.service en /lib/systemd/system/ de la siguiente manera:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_72fae6b3792e42cdac4a60053ade202d-1"&gt;&lt;/a&gt;nano /lib/systemd/system/odoo.service
&lt;/pre&gt;&lt;p&gt;Este archivo tendrá el siguiente contenido:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_db1d37ba05ca4a45a6246df52d189e48-1"&gt;&lt;/a&gt;&lt;span class="o"&gt;[&lt;/span&gt;Unit&lt;span class="o"&gt;]&lt;/span&gt;
&lt;a name="rest_code_db1d37ba05ca4a45a6246df52d189e48-2"&gt;&lt;/a&gt;&lt;span class="nv"&gt;Description&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Odoo 10.0
&lt;a name="rest_code_db1d37ba05ca4a45a6246df52d189e48-3"&gt;&lt;/a&gt;&lt;span class="nv"&gt;After&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;postgresql.service
&lt;a name="rest_code_db1d37ba05ca4a45a6246df52d189e48-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_db1d37ba05ca4a45a6246df52d189e48-5"&gt;&lt;/a&gt;&lt;span class="o"&gt;[&lt;/span&gt;Service&lt;span class="o"&gt;]&lt;/span&gt;
&lt;a name="rest_code_db1d37ba05ca4a45a6246df52d189e48-6"&gt;&lt;/a&gt;&lt;span class="nv"&gt;Type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;simple
&lt;a name="rest_code_db1d37ba05ca4a45a6246df52d189e48-7"&gt;&lt;/a&gt;&lt;span class="nv"&gt;User&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;odoo
&lt;a name="rest_code_db1d37ba05ca4a45a6246df52d189e48-8"&gt;&lt;/a&gt;&lt;span class="nv"&gt;Group&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;odoo
&lt;a name="rest_code_db1d37ba05ca4a45a6246df52d189e48-9"&gt;&lt;/a&gt;&lt;span class="nv"&gt;ExecStart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/home/odoo/odoo-prod/project/bin/start-odoo
&lt;a name="rest_code_db1d37ba05ca4a45a6246df52d189e48-10"&gt;&lt;/a&gt;
&lt;a name="rest_code_db1d37ba05ca4a45a6246df52d189e48-11"&gt;&lt;/a&gt;&lt;span class="o"&gt;[&lt;/span&gt;Install&lt;span class="o"&gt;]&lt;/span&gt;
&lt;a name="rest_code_db1d37ba05ca4a45a6246df52d189e48-12"&gt;&lt;/a&gt;&lt;span class="nv"&gt;WantedBy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;multi-user.target
&lt;/pre&gt;&lt;p&gt;Registramos el servicio:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_eba7e2e7885f41b6912e75d013bc7484-1"&gt;&lt;/a&gt;systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; odoo.service
&lt;/pre&gt;&lt;p&gt;Iniciamos el servicio:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_dc9158dc32c640a2a9442c35941acb60-1"&gt;&lt;/a&gt;service odoo start
&lt;/pre&gt;&lt;p&gt;Revisamos que al menos esté corriendo:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_cfc7000ee6524fadaf0c443d127a31b6-1"&gt;&lt;/a&gt;service odoo status
&lt;/pre&gt;&lt;p&gt;Y lo paramos:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_a6d3ee0aafd3436495bb9fe00f30759d-1"&gt;&lt;/a&gt;service odoo stop
&lt;/pre&gt;&lt;p&gt;Para probar el funcionamiento reiniciemos el servidor y veamos que odoo esté corriendo correctamente:&lt;/p&gt;
&lt;pre class="code bash"&gt;&lt;a name="rest_code_f0bd56aee7c34de6890581e380c480f8-1"&gt;&lt;/a&gt;reboot
&lt;/pre&gt;&lt;p&gt;Ahora probemos nuevamente:&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="http://IP_SERVER_ODOO:8069"&gt;http://IP_SERVER_ODOO:8069&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Y debemos ver la página de inicio del odoo.&lt;/p&gt;
&lt;p&gt;El siguiente artículo nos permitirá configurar odoo con nginx y estará muy bueno, hasta la próxima.&lt;/p&gt;
&lt;p&gt;Saludos.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>odoo</category><guid>http://pythonpiura.org/posts/instalacion-odoo-10-en-produccion/</guid><pubDate>Tue, 17 Jan 2017 04:56:00 GMT</pubDate></item></channel></rss>