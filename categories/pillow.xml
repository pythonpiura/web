<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>Python Piura (pillow)</title><link>http://pythonpiura.org/</link><description></description><atom:link rel="self" href="http://pythonpiura.org/categories/pillow.xml" type="application/rss+xml"></atom:link><language>en</language><lastBuildDate>Sun, 24 Jul 2016 19:38:25 GMT</lastBuildDate><generator>https://getnikola.com/</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Consulta DNI - RENIEC</title><link>http://pythonpiura.org/posts/2016/05/11/consulta-dni-reniec/</link><dc:creator>Miguel Amaya</dc:creator><description>&lt;div&gt;&lt;p&gt;En esta oportunidad vamos a hacer un ejemplo mas complejo, ya que el
captcha así lo amerita, nuestra página objetivo es la siguiente:&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://cel.reniec.gob.pe/valreg/valreg.do"&gt;https://cel.reniec.gob.pe/valreg/valreg.do&lt;/a&gt;&lt;/p&gt;
&lt;img alt="/images/blog/reniec.jpg" src="http://pythonpiura.org/images/blog/reniec.jpg"&gt;
&lt;p&gt;En esta página podemos ingresar el número de DNI y obtener el nombre
completo del ciudadano. Como se ve en la imagen aquí nos enfrentamos a
un captcha mas completo y a un teclado dinámico compuesto de botones,
para romper este captcha tenemos que modificar la imagen para obtener
el texto correcto, eliminando las lineas que atraviesan las letras y
que tienen una tonalidad distinta de azul, el proceso no será 100%
seguro pero funciona en la mayoría de los casos:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# -*- coding: utf-8 -*-&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;webdriver&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium.webdriver.common.by&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;By&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium.webdriver.support.wait&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;WebDriverWait&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-5"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;selenium.webdriver.support&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;expected_conditions&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;EC&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-6"&gt;&lt;/a&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-7"&gt;&lt;/a&gt;&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-8"&gt;&lt;/a&gt;        &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;Image&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-9"&gt;&lt;/a&gt;&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;ImportError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-10"&gt;&lt;/a&gt;        &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PIL&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Image&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-11"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pytesseract&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-12"&gt;&lt;/a&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-13"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;ir_reniec_web&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dni&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-14"&gt;&lt;/a&gt;        &lt;span class="n"&gt;fp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;webdriver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;FirefoxProfile&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-15"&gt;&lt;/a&gt;        &lt;span class="n"&gt;driver&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;webdriver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Firefox&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-16"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Definimos nuestra página objetivo&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-17"&gt;&lt;/a&gt;        &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"https://cel.reniec.gob.pe/valreg/valreg.do"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-18"&gt;&lt;/a&gt;        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-19"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Esperamos hasta que se cargue la imagen con el captcha&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-20"&gt;&lt;/a&gt;                &lt;span class="n"&gt;WebDriverWait&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;until&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;EC&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;presence_of_element_located&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;By&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ID&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"imagcodigo"&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-21"&gt;&lt;/a&gt;        &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-22"&gt;&lt;/a&gt;                &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;"Element is not present"&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-23"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Hacemos la captura de pantalla correspondiente&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-24"&gt;&lt;/a&gt;        &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save_screenshot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"screenshot.png"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-25"&gt;&lt;/a&gt;        &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'screenshot.png'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-26"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Obtenemos el ancho y el largo de la imagen&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-27"&gt;&lt;/a&gt;        &lt;span class="n"&gt;ancho&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-28"&gt;&lt;/a&gt;        &lt;span class="n"&gt;alto&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-29"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Recortamos la parte del captcha teniendo en cuenta el ancho y el largo de la imagen&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-30"&gt;&lt;/a&gt;        &lt;span class="n"&gt;img_recortada&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;crop&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ancho&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;4.26&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;alto&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;3.64&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ancho&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;2.8&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;alto&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-31"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Guardamos el recorte&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-32"&gt;&lt;/a&gt;        &lt;span class="n"&gt;img_recortada&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"recorte.png"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-33"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Recorremos cada uno de los dígitos del DNI&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-34"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;dni&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-35"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Buscamos el boton que tenga como nombre tecla_0&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-36"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_0"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-37"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el valor del botón con nombre tecla_0&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-38"&gt;&lt;/a&gt;                &lt;span class="n"&gt;valor_0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;boton_0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_attribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'value'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-39"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Buscamos el boton que tenga como nombre tecla_1&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-40"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_1"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-41"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el valor del botón con nombre tecla_1&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-42"&gt;&lt;/a&gt;                &lt;span class="n"&gt;valor_1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;boton_1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_attribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'value'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-43"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Buscamos el boton que tenga como nombre tecla_2&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-44"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_2"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-45"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el valor del botón con nombre tecla_2&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-46"&gt;&lt;/a&gt;                &lt;span class="n"&gt;valor_2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;boton_2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_attribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'value'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-47"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Buscamos el boton que tenga como nombre tecla_3&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-48"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_3"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-49"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el valor del botón con nombre tecla_3&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-50"&gt;&lt;/a&gt;                &lt;span class="n"&gt;valor_3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;boton_3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_attribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'value'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-51"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Buscamos el boton que tenga como nombre tecla_4&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-52"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_4&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_4"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-53"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el valor del botón con nombre tecla_4&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-54"&gt;&lt;/a&gt;                &lt;span class="n"&gt;valor_4&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;boton_4&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_attribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'value'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-55"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Buscamos el boton que tenga como nombre tecla_5&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-56"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_5&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_5"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-57"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el valor del botón con nombre tecla_5&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-58"&gt;&lt;/a&gt;                &lt;span class="n"&gt;valor_5&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;boton_5&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_attribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'value'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-59"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Buscamos el boton que tenga como nombre tecla_6&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-60"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_6&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_6"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-61"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el valor del botón con nombre tecla_6&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-62"&gt;&lt;/a&gt;                &lt;span class="n"&gt;valor_6&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;boton_6&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_attribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'value'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-63"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Buscamos el boton que tenga como nombre tecla_7&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-64"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_7&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_7"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-65"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el valor del botón con nombre tecla_7&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-66"&gt;&lt;/a&gt;                &lt;span class="n"&gt;valor_7&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;boton_7&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_attribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'value'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-67"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Buscamos el boton que tenga como nombre tecla_8&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-68"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_8&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_8"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-69"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el valor del botón con nombre tecla_8&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-70"&gt;&lt;/a&gt;                &lt;span class="n"&gt;valor_8&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;boton_8&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_attribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'value'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-71"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Buscamos el boton que tenga como nombre tecla_9&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-72"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_9&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_9"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-73"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el valor del botón con nombre tecla_9&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-74"&gt;&lt;/a&gt;                &lt;span class="n"&gt;valor_9&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;boton_9&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_attribute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'value'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-75"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Consultamos si el dígito del DNI es igual al valor del botón, si es el caso entonces se da click en ese botón&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-76"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;valor_0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-77"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-78"&gt;&lt;/a&gt;        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;valor_1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-79"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_1"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-80"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-81"&gt;&lt;/a&gt;        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;valor_2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-82"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_2"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-83"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-84"&gt;&lt;/a&gt;        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;valor_3&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-85"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_3"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-86"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-87"&gt;&lt;/a&gt;        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;valor_4&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-88"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_4&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_4"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-89"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_4&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-90"&gt;&lt;/a&gt;        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;valor_5&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-91"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_5&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_5"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-92"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_5&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-93"&gt;&lt;/a&gt;        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;valor_6&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-94"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_6&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_6"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-95"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_6&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-96"&gt;&lt;/a&gt;        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;valor_7&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-97"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_7&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_7"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-98"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_7&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-99"&gt;&lt;/a&gt;        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;valor_8&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-100"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_8&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_8"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-101"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_8&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-102"&gt;&lt;/a&gt;        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;valor_9&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-103"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_9&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"tecla_9"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-104"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_9&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-105"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Se llama al método romper_captcha para obtener el texto correspondiente&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-106"&gt;&lt;/a&gt;        &lt;span class="n"&gt;captcha&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;romper_captcha&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"recorte.png"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-107"&gt;&lt;/a&gt;        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-108"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos la caja de texto donde se escribe el texto del captcha&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-109"&gt;&lt;/a&gt;                &lt;span class="n"&gt;codigo&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"imagen"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-110"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Si el captcha está vacio o no se ha logrado romper se cierra el navegador y se termina la aplicación&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-111"&gt;&lt;/a&gt;                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;captcha&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s2"&gt;""&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-112"&gt;&lt;/a&gt;                        &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-113"&gt;&lt;/a&gt;                        &lt;span class="k"&gt;return&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-114"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Escribimos el texto&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-115"&gt;&lt;/a&gt;                &lt;span class="n"&gt;codigo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;send_keys&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;captcha&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-116"&gt;&lt;/a&gt;        &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-117"&gt;&lt;/a&gt;                &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-118"&gt;&lt;/a&gt;        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-119"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Obtenemos el botón de consulta&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-120"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_consultar&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"bot_consultar"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-121"&gt;&lt;/a&gt;                &lt;span class="c1"&gt;#Damos click al botón de consulta&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-122"&gt;&lt;/a&gt;                &lt;span class="n"&gt;boton_consultar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;click&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-123"&gt;&lt;/a&gt;        &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-124"&gt;&lt;/a&gt;                &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;"Element is not present"&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-125"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Obtengo el resultado que aparece en el elemento llamado style2&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-126"&gt;&lt;/a&gt;        &lt;span class="n"&gt;resultado&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_element_by_class_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"style2"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-127"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Partimos el resultado para obtener el nombre&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-128"&gt;&lt;/a&gt;        &lt;span class="n"&gt;nombre&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;resultado&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-129"&gt;&lt;/a&gt;        &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-130"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;nombre&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-131"&gt;&lt;/a&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-132"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;romper_captcha&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nombre_imagen&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-133"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Abro la imagen&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-134"&gt;&lt;/a&gt;        &lt;span class="n"&gt;img&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nombre_imagen&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-135"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Obtengo un arreglo de píxeles de la imagen&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-136"&gt;&lt;/a&gt;        &lt;span class="n"&gt;pixdata&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-137"&gt;&lt;/a&gt;        &lt;span class="sd"&gt;"""Modifico los píxeles de la imagen de acuerdo al análisis de los&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-138"&gt;&lt;/a&gt;&lt;span class="sd"&gt;        colores de las letras y las lineas que cruzan el texto, pintando de negro los píxeles del&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-139"&gt;&lt;/a&gt;&lt;span class="sd"&gt;        texto y de blanco las lineas"""&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-140"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]):&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-141"&gt;&lt;/a&gt;                &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]):&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-142"&gt;&lt;/a&gt;                        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;pixdata&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;146&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-143"&gt;&lt;/a&gt;                                &lt;span class="n"&gt;pixdata&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-144"&gt;&lt;/a&gt;        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]):&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-145"&gt;&lt;/a&gt;                &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;xrange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]):&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-146"&gt;&lt;/a&gt;                        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;pixdata&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;     &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-147"&gt;&lt;/a&gt;                                &lt;span class="n"&gt;pixdata&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-148"&gt;&lt;/a&gt;                        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-149"&gt;&lt;/a&gt;                                &lt;span class="n"&gt;pixdata&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-150"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Guardo la imagen modificada&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-151"&gt;&lt;/a&gt;        &lt;span class="n"&gt;img&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"modificado.jpg"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-152"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Abro la imagen modificado&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-153"&gt;&lt;/a&gt;        &lt;span class="n"&gt;image&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Image&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"modificado.jpg"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-154"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Obtenemos el texto de la imagen&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-155"&gt;&lt;/a&gt;        &lt;span class="n"&gt;frase&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pytesseract&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;image_to_string&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;image&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-156"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;#Retornamos el texto eliminado los espacios en blanco entre las palabras y convirtiendolas en mayúsculas&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-157"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;frase&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;' '&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s2"&gt;""&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;upper&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-158"&gt;&lt;/a&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-159"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-160"&gt;&lt;/a&gt;        &lt;span class="n"&gt;dni&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'123456789'&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-161"&gt;&lt;/a&gt;        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;ir_reniec_web&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dni&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-162"&gt;&lt;/a&gt;
&lt;a name="rest_code_7e9c4c5e37a14f41952337da7ff48077-163"&gt;&lt;/a&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Espero que les sea útil.
Saludos.&lt;/p&gt;&lt;/div&gt;</description><category>pillow</category><category>pytesseract</category><category>Python</category><category>Selenium</category><guid>http://pythonpiura.org/posts/2016/05/11/consulta-dni-reniec/</guid><pubDate>Thu, 12 May 2016 02:37:08 GMT</pubDate></item><item><title>Web Scrapping con Python y Selenium</title><link>http://pythonpiura.org/posts/2016/05/07/web-scrapping-con-python-y-selenium/</link><dc:creator>Miguel Amaya</dc:creator><description>&lt;p style="text-align:justify;"&gt;El día de hoy tuvimos el agrado de ser invitados por el &lt;a href="https://cideuel.wordpress.com/"&gt;Círculo UEL&lt;/a&gt; a dar una charla en el marco del FLISOL 2016 en la Universidad Los Ángeles de Chimbote Sede Piura y el tema fue Web Scrapping con Python y Selenium, hicimos algunos ejemplos muy interesantes y nos encantó la acogida del público y el interés suscitado, vamos a compartir los artículos que usamos:&lt;/p&gt;
&lt;p style="text-align:justify;"&gt;&lt;a href="https://pythonpiura.wordpress.com/2014/09/18/selenium-con-python/"&gt;Selenium con Python&lt;/a&gt;&lt;/p&gt;
&lt;p style="text-align:justify;"&gt;&lt;a href="https://pythonpiura.wordpress.com/2016/01/26/romper-captchas-con-pytesseract-y-selenium/"&gt;Romper Captchas con Pytesseract y Selenium&lt;/a&gt;&lt;/p&gt;
&lt;p style="text-align:justify;"&gt;Las diapositivas:&lt;/p&gt;
&lt;p style="text-align:justify;"&gt;&lt;a href="http://pythonpiura.org/2016/05/charlapythonflisol2016.pdf"&gt;Descargar&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;El script que fue la estrella de la mañana:&lt;/p&gt;
&lt;p&gt;[sourcecode language="python"]&lt;br&gt;
# -*- coding: utf-8 -*-&lt;br&gt;
from selenium import webdriver&lt;br&gt;
from selenium.webdriver.common.by import By&lt;br&gt;
from selenium.webdriver.support.wait import WebDriverWait&lt;br&gt;
from selenium.webdriver.support import expected_conditions as EC&lt;br&gt;
import os&lt;/p&gt;
&lt;p&gt;try:&lt;br&gt;
    import Image&lt;br&gt;
except ImportError:&lt;br&gt;
    from PIL import Image&lt;br&gt;
import pytesseract&lt;/p&gt;
&lt;p&gt;def decodifica_campo(campo):&lt;br&gt;
	return u"%s" % campo&lt;/p&gt;
&lt;p&gt;def ir_sunat_web(ruta):&lt;br&gt;
	fp = webdriver.FirefoxProfile()&lt;br&gt;
	fp.set_preference("browser.download.manager.showWhenStarting",False)&lt;br&gt;
	fp.set_preference("browser.download.manager.closeWhenDone", True);&lt;br&gt;
	fp.set_preference("browser.download.manager.showAlertOnComplete", False);&lt;br&gt;
	fp.set_preference("browser.helperApps.neverAsk.saveToDisk", "application/zip");&lt;br&gt;
	driver = webdriver.Firefox(fp)&lt;br&gt;
	driver.get("http://www.sunat.gob.pe/cl-ti-itmrconsmulruc/jrmS00Alias")&lt;br&gt;
	try:&lt;br&gt;
		WebDriverWait(driver, 5).until(EC.presence_of_element_located((By.NAME, "imagen")))&lt;br&gt;
	except:&lt;br&gt;
		print "No carga imagen"&lt;br&gt;
	driver.save_screenshot("screenshot.png")&lt;br&gt;
	img=Image.open(‘screenshot.png’)&lt;br&gt;
	img_recortada = img.crop((700,309,800,361))&lt;br&gt;
	img_recortada.save("recorte.png")&lt;br&gt;
        try:&lt;br&gt;
            captcha = pytesseract.image_to_string(img_recortada)&lt;br&gt;
            codigo = driver.find_element_by_name("codigoA")&lt;br&gt;
            codigo.send_keys(captcha)&lt;br&gt;
        except:&lt;br&gt;
            pass&lt;br&gt;
	archivo = driver.find_element_by_name("archivo")&lt;br&gt;
	archivo.send_keys(ruta)&lt;br&gt;
	form = driver.find_element_by_name("frmConsMulRucArchivo")&lt;br&gt;
	botones=form.find_elements_by_class_name("form-button")&lt;br&gt;
	botones[1].click()&lt;br&gt;
	try:&lt;br&gt;
		WebDriverWait(driver, 5).until(EC.presence_of_all_elements_located((By.CLASS_NAME, "form-table")))&lt;br&gt;
		enlace=driver.find_element(By.TAG_NAME,"a")&lt;br&gt;
		enlace.click()&lt;br&gt;
	except:&lt;br&gt;
		print "Element is not present"&lt;br&gt;
	driver.close()&lt;/p&gt;
&lt;p&gt;def main():&lt;br&gt;
	ruta = "/home/usuario/carpeta"&lt;br&gt;
	ruta_archivo=os.path.join(ruta,"rucs.zip")&lt;br&gt;
	ir_sunat_web(ruta_archivo)&lt;/p&gt;
&lt;p&gt;main()&lt;br&gt;
[/sourcecode]&lt;/p&gt;
&lt;p&gt;Así como también un vídeo de su funcionamiento.&lt;/p&gt;
&lt;p&gt;http://www.youtube.com/watch?v=mUaVFYTlibM&lt;/p&gt;
&lt;p&gt;Saludos y muchas gracias.&lt;/p&gt;
</description><category>pillow</category><category>pytesseract</category><category>Python</category><category>Selenium</category><guid>http://pythonpiura.org/posts/2016/05/07/web-scrapping-con-python-y-selenium/</guid><pubDate>Sun, 08 May 2016 01:58:06 GMT</pubDate></item></channel></rss>