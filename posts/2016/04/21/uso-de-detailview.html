<html><body><p style="text-align:justify;">Luego de haber visto el uso de TemplateView, CreateView y ListView, estos dos últimos los vimos de pasada casi sin mencionarlos, ahora vamos a agregar un par de nuevas funcionalidades a nuestro proyecto tutorial, para ello empezaremos modificando el archivo personas.html para agregarle un par de enlaces que nos van a permitir editar y ver el detalle de una persona en cuestión, en este post solamente cubriremos la funcionalidad de ver el detalle, posteriormente en otro post nos encargaremos de la funcionalidad de editar a la persona:</p>
<p>[sourcecode language="html"]<br>
{% extends "base.html" %}<br>
{% block cuerpo %}<br>
&lt;div class="row"&gt;<br>
    &lt;div class="col-lg-12"&gt;<br>
        &lt;h1 class="page-header"&gt;Tablas&lt;/h1&gt;<br>
    &lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div class="row"&gt;<br>
	&lt;div class="col-lg-12"&gt;<br>
		&lt;div class="panel panel-info"&gt;<br>
			&lt;div class="panel-heading"&gt;<br>
			    Personas<br>
			&lt;/div&gt;<br>
			&lt;div class="panel-body"&gt;<br>
				&lt;div class=’form-group’&gt;<br>
					&lt;div class="row"&gt;<br>
						&lt;div class="col-lg-10"&gt;	</p>
<p>						&lt;/div&gt;<br>
						&lt;div class="col-lg-1"&gt;<br>
							&lt;a id="crear_detalle" href="{% url ‘personas:reporte_personas_excel’ %}" class="btn btn-info btn-block"&gt;<br>
								&lt;span class="glyphicon glyphicon-list-alt"&gt;&lt;/span&gt;<br>
							&lt;/a&gt;<br>
						&lt;/div&gt;<br>
						&lt;div class="col-lg-1"&gt;<br>
							&lt;a id="crear_detalle" href="{% url ‘personas:crear_persona’ %}" class="btn btn-info btn-block"&gt;<br>
								&lt;span class="glyphicon glyphicon-plus"&gt;&lt;/span&gt;<br>
							&lt;/a&gt;<br>
						&lt;/div&gt;<br>
					&lt;/div&gt;<br>
				&lt;/div&gt;<br>
				&lt;div class="row"&gt;<br>
					&lt;div class="col-lg-12"&gt;<br>
						&lt;table id="tabla" class="table table-striped table-bordered" cellspacing="0" width="100%"&gt;<br>
							&lt;thead&gt;<br>
								&lt;tr&gt;<br>
									&lt;th class="text-center"&gt;DNI&lt;/th&gt;<br>
									&lt;th class="text-center"&gt;NOMBRE&lt;/th&gt;<br>
									&lt;th class="text-center"&gt;APELLIDO PATERNO&lt;/th&gt;<br>
									&lt;th class="text-center"&gt;APELLIDO MATERNO&lt;/th&gt;<br>
									&lt;th class="text-center"&gt;ACCIONES&lt;/th&gt;<br>
								&lt;/tr&gt;<br>
							&lt;/thead&gt;<br>
							&lt;tbody&gt;<br>
							{% for persona in personas %}<br>
								&lt;tr&gt;<br>
									&lt;td&gt;{{ persona.dni }}&lt;/td&gt;<br>
									&lt;td&gt;{{ persona.nombre }}&lt;/td&gt;<br>
									&lt;td&gt;{{ persona.apellido_paterno }}&lt;/td&gt;<br>
									&lt;td&gt;{{ persona.apellido_materno }}&lt;/td&gt;<br>
									&lt;td class="text-center"&gt;<br>
										&lt;a class="btn btn-small" href="#"&gt;<br>
							                &lt;span class="glyphicon glyphicon-folder-open"&gt;&lt;/span&gt;<br>
							            &lt;/a&gt;<br>
							            &lt;a class="btn btn-small" href="#"&gt;<br>
							                &lt;span class="glyphicon glyphicon-pencil"&gt;&lt;/span&gt;<br>
							            &lt;/a&gt;<br>
							        &lt;/td&gt;<br>
								&lt;/tr&gt;<br>
							{% endfor %}<br>
							&lt;/tbody&gt;<br>
						&lt;/table&gt;<br>
					&lt;/div&gt;<br>
				&lt;/div&gt;<br>
			&lt;/div&gt;<br>
		&lt;/div&gt;<br>
	&lt;/div&gt;<br>
&lt;/div&gt;<br>
{% endblock cuerpo %}<br>
{% block js %}<br>
&lt;script&gt;<br>
$(document).ready(function()<br>
{<br>
    var table = $(‘#tabla’).DataTable( {<br>
        "language": {<br>
        	url: "/static/localizacion/es_ES.json"<br>
        }<br>
    } );</p>
<p>    $(‘#tabla tbody’).on( ‘click’, ‘tr’, function()<br>
    {<br>
    	if ($(this).hasClass(‘selected’) )<br>
        {<br>
        	$(this).removeClass(‘selected’);</p>
<p>        }<br>
        else<br>
        {<br>
	        table.$(‘tr.selected’).removeClass(‘selected’);<br>
	        $(this).addClass(‘selected’);<br>
        }<br>
    });   </p>
<p>});<br>
&lt;/script&gt;<br>
{% endblock js %}<br>
[/sourcecode]</p>
<p style="text-align:justify;">Nótese que en la cabecera de la tabla hemos puesto el encabezado acciones y que dentro del cuerpo de la tabla se ha agregado una columna que contiene dos enlaces: uno con el ícono de un libro y otro con el ícono de un lapiz, ambos son, para ver el detalle de la persona y el otro para editarlo.</p>
<p><a href="/2016/04/tabla_nueva.jpg"><img class="aligncenter wp-image-174" src="https://pythonpiura.files.wordpress.com/2016/04/tabla_nueva.jpg?w=300" alt="tabla_nueva" width="568" height="191"></a></p>
<p style="text-align:justify;">Ahora vamos a implementar la funcionalidad de ver el detalle de la persona, para ello usamos la clase DetailView, esta clase nos simplifica la vida ya que nos permite mostrar el detalle de un modelo en particular, debiendo definir el modelo al que haremos referencia y la plantilla donde se renderizará el contenido:</p>
<p>[sourcecode language="python"]<br>
from django.views.generic.detail import DetailView<br>
class DetallePersona(DetailView):<br>
    model = Persona<br>
    template_name = ‘detalle_persona.html’<br>
[/sourcecode]</p>
<p>Ahora debemos crear la plantilla detalle_persona.html:</p>
<p>[sourcecode language="html"]<br>
{% extends "base.html" %}<br>
{% block cuerpo %}<br>
&lt;div class="row"&gt;<br>
    &lt;div class="col-lg-12"&gt;<br>
        &lt;h1 class="page-header"&gt;Personas&lt;/h1&gt;<br>
    &lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div class="row"&gt;<br>
	&lt;div class="col-lg-12"&gt;<br>
		&lt;div class="panel panel-info"&gt;<br>
			&lt;div class="panel-heading"&gt;<br>
			    Detalle de Persona<br>
			&lt;/div&gt;<br>
			&lt;div class="panel-body"&gt;<br>
				&lt;div class=’form-group’&gt;<br>
					&lt;div class="row"&gt;<br>
						&lt;div class="col-md-12"&gt;<br>
							&lt;label&gt;DNI:&lt;/label&gt;<br>
							&lt;p&gt;{{ object.dni }}&lt;/p&gt;<br>
							&lt;label&gt;NOMBRE:&lt;/label&gt;<br>
							&lt;p&gt;{{ object.nombre }}&lt;/p&gt;<br>
							&lt;label&gt;APELLIDO PATERNO:&lt;/label&gt;<br>
							&lt;p&gt;{{ object.apellido_paterno }}&lt;/p&gt;<br>
							&lt;label&gt;APELLIDO MATERNO: &lt;/label&gt;<br>
							&lt;p&gt;{{ object.apellido_materno }}&lt;/p&gt;<br>
						&lt;/div&gt;<br>
					&lt;/div&gt;<br>
				&lt;/div&gt;<br>
			&lt;/div&gt;<br>
		&lt;/div&gt;<br>
	&lt;/div&gt;<br>
&lt;/div&gt;<br>
{% endblock cuerpo %}<br>
[/sourcecode]</p>
<p>Modificamos el archivo urls.py para crear el url detalle_persona:</p>
<p>[sourcecode language="python"]<br>
from django.conf.urls import patterns, url<br>
from personas.views import Personas, CrearPersona, ReportePersonasExcel,\<br>
    Bienvenida, DetallePersona</p>
<p>urlpatterns = patterns(”,<br>
    url(r’^$’,Bienvenida.as_view(), name="bienvenida"),<br>
    url(r’^personas/$’,Personas.as_view(), name="personas"),<br>
    url(r’^crear_persona/$’,CrearPersona.as_view(), name="crear_persona"),<br>
    url(r’^reporte_personas_excel/$’,ReportePersonasExcel.as_view(), name="reporte_personas_excel"),<br>
    url(r’^detalle_persona/(?P&lt;pk&gt;\d+)/$’, DetallePersona.as_view(), name="detalle_persona"),<br>
)<br>
[/sourcecode]</p>
<p style="text-align:justify;">Ahora hacemos que el enlace con el ícono del libro abierto apunte a nuestra url detalle_persona, debemos tener en cuenta que el enlace debe estar de acuerdo a la definición de la expresión regular en la url, en este caso se le pasa como argumento la primary key que debe ser un conjunto de dígitos:</p>
<p>[sourcecode language="html"]<br>
&lt;a class="btn btn-small" href="{% url ‘personas:detalle_persona’ persona.pk %}"&gt;<br>
	&lt;span class="glyphicon glyphicon-folder-open"&gt;&lt;/span&gt;<br>
&lt;/a&gt;<br>
[/sourcecode]</p>
<p>Ahora cuando hagamos click en el ícono del lápiz nos mostrará lo siguiente:</p>
<p><a href="/2016/04/detalle_persona.jpg"><img class="alignnone size-medium wp-image-175" src="https://pythonpiura.files.wordpress.com/2016/04/detalle_persona.jpg?w=300" alt="detalle_persona" width="400" height="125"></a></p>
<p>Eso es todo.</p>
<p>Saludos.</p>
</body></html>