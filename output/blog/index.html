<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="es">
<head>
<meta charset="utf-8">
<meta name="description" content="Comunidad Python Piura">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Python Piura</title>
<link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../rss.xml">
<link rel="canonical" href="http://pythonpiura.org/blog/">
<link rel="next" href="index-3.html" type="text/html">
<!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Ir al contenido principal</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Mostrar navegación</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://pythonpiura.org/">

                <span id="blog-title">Python Piura</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../blog">Blog</a>
                </li>
<li>
<a href="../eventos">Eventos</a>
                </li>
<li>
<a href="../recursos">Recursos</a>
                </li>
<li>
<a href="../contactenos">Contáctenos</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

    
<div class="postindex">
    <article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="../posts/implementando-django-formsets/" class="u-url">Implementando Django Formsets</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Comunidad Python Piura
            </span></p>
            <p class="dateline"><a href="../posts/implementando-django-formsets/" rel="bookmark"><time class="published dt-published" datetime="2017-10-18T19:03:29-05:00" title="2017-10-18 19:03">2017-10-18 19:03</time></a></p>
                <p class="commentline">
        
    <a href="../posts/implementando-django-formsets/#disqus_thread" data-disqus-identifier="cache/posts/implementando-django-formsets.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>En esta oportunidad vamos a trabajar con los formsets de Django que son muy interesantes y pueden ser de mucha ayuda cuando tenemos múltiples filas con detalles a rellenar, como por ejemplo los detalles de una compra. Vamos a seguir utilizando el proyecto llamado modales que hemos venido usando en posts anteriores y que ya tiene varios modelos listos para ser usados:</p>
<p>Vamos a crear un nuevo modelo llamado compra:</p>
<pre class="code python"><a name="rest_code_89b0cc55c33d4f20a3ab67997220b636-1"></a><span class="k">class</span> <span class="nc">Compra</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a name="rest_code_89b0cc55c33d4f20a3ab67997220b636-2"></a>    <span class="n">proveedor</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Proveedor</span><span class="p">)</span>
<a name="rest_code_89b0cc55c33d4f20a3ab67997220b636-3"></a>    <span class="n">fecha</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre>
<p>Como podemos ver este modelo Compra tiene dos atributos proveedor, donde se utiliza el modelo Proveedor que ya hemos usado, y fecha, que se asigna automáticamente la fecha actual.</p>
<p>También creamos el modelo DetalleCompra:</p>
<pre class="code python"><a name="rest_code_d4e62e0f719342c9802b82d5263a0ee8-1"></a><span class="k">class</span> <span class="nc">DetalleCompra</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a name="rest_code_d4e62e0f719342c9802b82d5263a0ee8-2"></a>    <span class="n">compra</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Compra</span><span class="p">)</span>
<a name="rest_code_d4e62e0f719342c9802b82d5263a0ee8-3"></a>    <span class="n">producto</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Producto</span><span class="p">)</span>
<a name="rest_code_d4e62e0f719342c9802b82d5263a0ee8-4"></a>    <span class="n">cantidad</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DecimalField</span><span class="p">(</span><span class="n">max_digits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a name="rest_code_d4e62e0f719342c9802b82d5263a0ee8-5"></a>    <span class="n">precio_compra</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DecimalField</span><span class="p">(</span><span class="n">max_digits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre>
<p>Este modelo tiene el detalle de la compra con los siguientes atributos: "compra" que referencia al modelo "cabecera"(por llamarlo de alguna manera), "producto" que hace la referencia al modelo Producto, cantidad para guardar la cantidad del producto comprado y el precio_compra para guardar el precio del producto en esa compra.</p>
<p>Igual que con los ejemplos anteriores primero vamos a mostrar un listado de las compras para ello necesitamos una vista, un template y su correspondiente url.</p>
<p>Creamos la clase ListadoCompras basada en la clase ListView:</p>
<pre class="code python"><a name="rest_code_17bed04c6b5d4fce88069ab7ca505c96-1"></a><span class="k">class</span> <span class="nc">ListadoCompras</span><span class="p">(</span><span class="n">ListView</span><span class="p">):</span>
<a name="rest_code_17bed04c6b5d4fce88069ab7ca505c96-2"></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">Compra</span>
<a name="rest_code_17bed04c6b5d4fce88069ab7ca505c96-3"></a>    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">'compras.html'</span>
<a name="rest_code_17bed04c6b5d4fce88069ab7ca505c96-4"></a>    <span class="n">context_object_name</span> <span class="o">=</span> <span class="s1">'compras'</span>
</pre>
<p>Creamos la plantilla compras.html:</p>
<pre class="code html"><a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-1"></a>{% extends "base.html" %}
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-2"></a>{% block cuerpo %}
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-3"></a><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>Compras<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-4"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"row"</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-5"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-lg-10"</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-6"></a>                <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"{% url 'productos:crear_compra' %}"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn btn-primary"</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-7"></a>                        Crear
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-8"></a>                <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-9"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-10"></a><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-11"></a><span class="p">&lt;</span><span class="nt">hr</span><span class="p">/&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-12"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"row"</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-13"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-lg-12"</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-14"></a>                <span class="p">&lt;</span><span class="nt">table</span> <span class="na">id</span><span class="o">=</span><span class="s">"tabla"</span> <span class="na">class</span><span class="o">=</span><span class="s">"display"</span> <span class="na">cellspacing</span><span class="o">=</span><span class="s">"0"</span> <span class="na">width</span><span class="o">=</span><span class="s">"100%"</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-15"></a>                        <span class="p">&lt;</span><span class="nt">thead</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-16"></a>                                <span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-17"></a>                                        <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">"text-center"</span><span class="p">&gt;</span>PROVEEDOR<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-18"></a>                                        <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">"text-center"</span><span class="p">&gt;</span>FECHA<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-19"></a>                                        <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">"text-center"</span><span class="p">&gt;</span>ACCIONES<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-20"></a>                                <span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-21"></a>                        <span class="p">&lt;/</span><span class="nt">thead</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-22"></a>                        <span class="p">&lt;</span><span class="nt">tbody</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-23"></a>                        {% for compra in compras %}
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-24"></a>                <span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-25"></a>                    <span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;</span>{{ compra.proveedor }}<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-26"></a>                    <span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;</span>{{ compra.fecha }}<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-27"></a>                    <span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">"text-center"</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-28"></a>                        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn"</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-29"></a>                            <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">"glyphicon glyphicon-eye-open"</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-30"></a>                        <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-31"></a>                        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">"#"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn"</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-32"></a>                            <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">"glyphicon glyphicon-edit"</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-33"></a>                        <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-34"></a>                    <span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-35"></a>                                <span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-36"></a>                        {% endfor %}
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-37"></a>                        <span class="p">&lt;/</span><span class="nt">tbody</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-38"></a>                <span class="p">&lt;/</span><span class="nt">table</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-39"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-40"></a><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-41"></a>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-42"></a><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-43"></a>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-44"></a><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-45"></a><span class="p">{</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-46"></a>    <span class="kd">var</span> <span class="nx">table</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#tabla'</span><span class="p">).</span><span class="nx">dataTable</span><span class="p">(</span> <span class="p">{</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-47"></a>        <span class="s2">"language"</span><span class="o">:</span> <span class="p">{</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-48"></a>                <span class="nx">url</span><span class="o">:</span> <span class="s2">"/static/localizacion/es_ES.json"</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-49"></a>        <span class="p">}</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-50"></a>    <span class="p">}</span> <span class="p">);</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-51"></a><span class="p">});</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-52"></a><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<a name="rest_code_33f8016be1ee4d8dbe24e73d37f040c6-53"></a>{% endblock cuerpo %}
</pre>
<p>Añadimos la url correspondiente, nótese que también se usa en esa plantilla la url "productos:crear_compra" por lo que debemos incluirla y crear una clase vacia para no tener problemas:</p>
<pre class="code python"><a name="rest_code_2f4b7e768434481ba63cb96dc124c603-1"></a><span class="k">class</span> <span class="nc">CrearCompra</span><span class="p">(</span><span class="n">CreateView</span><span class="p">):</span>
<a name="rest_code_2f4b7e768434481ba63cb96dc124c603-2"></a>        <span class="k">pass</span>
</pre>
<p>Ahora editamos el archivo urls.py:</p>
<pre class="code python"><a name="rest_code_4094c8f5fb634a8b9bb61c10beb58b9d-1"></a><span class="kn">from</span> <span class="nn">productos.views</span> <span class="kn">import</span> <span class="n">ListadoCompras</span><span class="p">,</span> <span class="n">CrearCompra</span>
<a name="rest_code_4094c8f5fb634a8b9bb61c10beb58b9d-2"></a>
<a name="rest_code_4094c8f5fb634a8b9bb61c10beb58b9d-3"></a><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
<a name="rest_code_4094c8f5fb634a8b9bb61c10beb58b9d-4"></a>        <span class="o">...</span>
<a name="rest_code_4094c8f5fb634a8b9bb61c10beb58b9d-5"></a>        <span class="n">url</span><span class="p">(</span><span class="s1">r'^compras/$'</span><span class="p">,</span> <span class="n">ListadoCompras</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">"listado_compras"</span><span class="p">),</span>
<a name="rest_code_4094c8f5fb634a8b9bb61c10beb58b9d-6"></a>        <span class="n">url</span><span class="p">(</span><span class="s1">r'^crear_compra/$'</span><span class="p">,</span> <span class="n">CrearCompra</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">"crear_compra"</span><span class="p">),</span>
<a name="rest_code_4094c8f5fb634a8b9bb61c10beb58b9d-7"></a><span class="p">]</span>
</pre>
<p>Si en el navegador ponemos la url <a class="reference external" href="http://localhost:8000/compras/">http://localhost:8000/compras/</a> nos debe aparecer la siguiente pantalla:</p>
<img alt="/images/blog/listado_compras.png" src="../images/blog/listado_compras.png"><p>Editamos el archivo forms.py para crear los formularios que necesitamos.</p>
<p>Creamos el formulario para la compra usando un ModelForm y con el campo proveedor:</p>
<pre class="code python"><a name="rest_code_eebfce86d0694ef5a2f8dc7eae41f4c9-1"></a><span class="k">class</span> <span class="nc">CompraForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
<a name="rest_code_eebfce86d0694ef5a2f8dc7eae41f4c9-2"></a>
<a name="rest_code_eebfce86d0694ef5a2f8dc7eae41f4c9-3"></a>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
<a name="rest_code_eebfce86d0694ef5a2f8dc7eae41f4c9-4"></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">Compra</span>
<a name="rest_code_eebfce86d0694ef5a2f8dc7eae41f4c9-5"></a>        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'proveedor'</span><span class="p">]</span>
<a name="rest_code_eebfce86d0694ef5a2f8dc7eae41f4c9-6"></a>
<a name="rest_code_eebfce86d0694ef5a2f8dc7eae41f4c9-7"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a name="rest_code_eebfce86d0694ef5a2f8dc7eae41f4c9-8"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">CompraForm</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a name="rest_code_eebfce86d0694ef5a2f8dc7eae41f4c9-9"></a>        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">):</span>
<a name="rest_code_eebfce86d0694ef5a2f8dc7eae41f4c9-10"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
<a name="rest_code_eebfce86d0694ef5a2f8dc7eae41f4c9-11"></a>                <span class="s1">'class'</span><span class="p">:</span> <span class="s1">'form-control'</span>
<a name="rest_code_eebfce86d0694ef5a2f8dc7eae41f4c9-12"></a>            <span class="p">})</span>
</pre>
<p>Creamos nuestro formulario del Detalle de la compra usando también un ModelForm y con los campos producto, cantidad y precio_compra:</p>
<pre class="code python"><a name="rest_code_6bef6712e2444563b7615e7473380e27-1"></a><span class="k">class</span> <span class="nc">DetalleCompraForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
<a name="rest_code_6bef6712e2444563b7615e7473380e27-2"></a>
<a name="rest_code_6bef6712e2444563b7615e7473380e27-3"></a>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
<a name="rest_code_6bef6712e2444563b7615e7473380e27-4"></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">DetalleCompra</span>
<a name="rest_code_6bef6712e2444563b7615e7473380e27-5"></a>        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'producto'</span><span class="p">,</span><span class="s1">'cantidad'</span><span class="p">,</span><span class="s1">'precio_compra'</span><span class="p">]</span>
<a name="rest_code_6bef6712e2444563b7615e7473380e27-6"></a>
<a name="rest_code_6bef6712e2444563b7615e7473380e27-7"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a name="rest_code_6bef6712e2444563b7615e7473380e27-8"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">DetalleCompraForm</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a name="rest_code_6bef6712e2444563b7615e7473380e27-9"></a>        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">):</span>
<a name="rest_code_6bef6712e2444563b7615e7473380e27-10"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
<a name="rest_code_6bef6712e2444563b7615e7473380e27-11"></a>                <span class="s1">'class'</span><span class="p">:</span> <span class="s1">'form-control'</span>
<a name="rest_code_6bef6712e2444563b7615e7473380e27-12"></a>            <span class="p">})</span>
<a name="rest_code_6bef6712e2444563b7615e7473380e27-13"></a>
<a name="rest_code_6bef6712e2444563b7615e7473380e27-14"></a>    <span class="k">def</span> <span class="nf">clean_cantidad</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_6bef6712e2444563b7615e7473380e27-15"></a>        <span class="n">cantidad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">'cantidad'</span><span class="p">]</span>
<a name="rest_code_6bef6712e2444563b7615e7473380e27-16"></a>        <span class="k">if</span> <span class="n">cantidad</span> <span class="o">==</span> <span class="s1">''</span><span class="p">:</span>
<a name="rest_code_6bef6712e2444563b7615e7473380e27-17"></a>            <span class="k">raise</span> <span class="n">forms</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="s2">"Debe ingresar una cantidad valida"</span><span class="p">)</span>
<a name="rest_code_6bef6712e2444563b7615e7473380e27-18"></a>        <span class="k">return</span> <span class="n">cantidad</span>
<a name="rest_code_6bef6712e2444563b7615e7473380e27-19"></a>
<a name="rest_code_6bef6712e2444563b7615e7473380e27-20"></a>    <span class="k">def</span> <span class="nf">clean_precio_compra</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_6bef6712e2444563b7615e7473380e27-21"></a>        <span class="n">precio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleaned_data</span><span class="p">[</span><span class="s1">'precio_compra'</span><span class="p">]</span>
<a name="rest_code_6bef6712e2444563b7615e7473380e27-22"></a>        <span class="k">if</span> <span class="n">precio</span> <span class="o">==</span> <span class="s1">''</span><span class="p">:</span>
<a name="rest_code_6bef6712e2444563b7615e7473380e27-23"></a>            <span class="k">raise</span> <span class="n">forms</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="s2">"Debe ingresar un precio valido"</span><span class="p">)</span>
<a name="rest_code_6bef6712e2444563b7615e7473380e27-24"></a>        <span class="k">return</span> <span class="n">precio</span>
</pre>
<p>Nótese que hemos creados dos métodos "clean" para hacer las validaciones correspondientes tanto de cantidad como de precio_compra.</p>
<p>Ahora si vamos a crear un formset en linea, estos son una pequeña capa de abstracción que simplifica trabajar con objetos relacionados a través de una clave foránea:</p>
<pre class="code python"><a name="rest_code_0d11c703def54f6a908b080452e151df-1"></a><span class="kn">from</span> <span class="nn">django.forms.models</span> <span class="kn">import</span> <span class="n">inlineformset_factory</span>
<a name="rest_code_0d11c703def54f6a908b080452e151df-2"></a>
<a name="rest_code_0d11c703def54f6a908b080452e151df-3"></a><span class="n">DetalleCompraFormSet</span> <span class="o">=</span> <span class="n">inlineformset_factory</span><span class="p">(</span><span class="n">Compra</span><span class="p">,</span> <span class="n">DetalleCompra</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">DetalleCompraForm</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre>
<p>Para hacerlo llamamos al método inlineformset_factory que usa a su vez al método modelformset_factory() pero con el argumento para borrar can_delete=True. Este método tiene como argumentos el modelo foráneo Compra, el modelo DetalleCompra que aparecerá en cada una de las filas, el formulario DetalleCompraForm que se corresponde con el modelo DetalleCompra y el parámetro extra que indica que aparecerán por defecto 4 filas.</p>
<p>Modificamos la vista CrearCompra para poder utilizar los formularios, para ello editamos el archivo views.py:</p>
<pre class="code python"><a name="rest_code_721f236eea874d51ad3d0c437a1a03b6-1"></a><span class="kn">from</span> <span class="nn">productos.forms</span> <span class="kn">import</span> <span class="n">CompraForm</span><span class="p">,</span> <span class="n">DetalleCompraFormSet</span>
<a name="rest_code_721f236eea874d51ad3d0c437a1a03b6-2"></a>
<a name="rest_code_721f236eea874d51ad3d0c437a1a03b6-3"></a><span class="k">class</span> <span class="nc">CrearCompra</span><span class="p">(</span><span class="n">CreateView</span><span class="p">):</span>
<a name="rest_code_721f236eea874d51ad3d0c437a1a03b6-4"></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">Compra</span>
<a name="rest_code_721f236eea874d51ad3d0c437a1a03b6-5"></a>    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">'compra.html'</span>
<a name="rest_code_721f236eea874d51ad3d0c437a1a03b6-6"></a>    <span class="n">form_class</span> <span class="o">=</span> <span class="n">CompraForm</span>
<a name="rest_code_721f236eea874d51ad3d0c437a1a03b6-7"></a>    <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">'productos:listado_compras'</span><span class="p">)</span>
</pre>
<p>En esta primera parte tenemos una clase basada en CreateView para facilitarnos la vida, con el modelo Compra, la plantilla 'compra.html' y el formulario CompraForm, el atributo success_url indica la dirección donde se va a retornar una vez que la creación del objeto haya sido concretada con éxito.</p>
<p>A continuación pasamos a describir el método get que va a ser necesario para mostrar el formulario cuando se llama a la url, vamos a explicar cada una de las lineas con comentarios:</p>
<pre class="code python"><a name="rest_code_6638a80fe43f48c7b02cb75834bd0f09-1"></a><span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a name="rest_code_6638a80fe43f48c7b02cb75834bd0f09-2"></a>    <span class="sd">"""Primero ponemos nuestro object como nulo, se debe tener en</span>
<a name="rest_code_6638a80fe43f48c7b02cb75834bd0f09-3"></a><span class="sd">    cuenta que object se usa en la clase CreateView para crear el objeto"""</span>
<a name="rest_code_6638a80fe43f48c7b02cb75834bd0f09-4"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="bp">None</span>
<a name="rest_code_6638a80fe43f48c7b02cb75834bd0f09-5"></a>    <span class="c1">#Instanciamos el formulario de la Compra que declaramos en la variable form_class</span>
<a name="rest_code_6638a80fe43f48c7b02cb75834bd0f09-6"></a>    <span class="n">form_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_form_class</span><span class="p">()</span>
<a name="rest_code_6638a80fe43f48c7b02cb75834bd0f09-7"></a>    <span class="n">form</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_form</span><span class="p">(</span><span class="n">form_class</span><span class="p">)</span>
<a name="rest_code_6638a80fe43f48c7b02cb75834bd0f09-8"></a>    <span class="c1">#Instanciamos el formset</span>
<a name="rest_code_6638a80fe43f48c7b02cb75834bd0f09-9"></a>    <span class="n">detalle_orden_compra_formset</span><span class="o">=</span><span class="n">DetalleCompraFormSet</span><span class="p">()</span>
<a name="rest_code_6638a80fe43f48c7b02cb75834bd0f09-10"></a>    <span class="c1">#Renderizamos el formulario de la compra y el formset</span>
<a name="rest_code_6638a80fe43f48c7b02cb75834bd0f09-11"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">render_to_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">,</span>
<a name="rest_code_6638a80fe43f48c7b02cb75834bd0f09-12"></a>                                                         <span class="n">detalle_compra_form_set</span><span class="o">=</span><span class="n">detalle_orden_compra_formset</span><span class="p">))</span>
</pre>
<p>Es necesario ahora crear un método post para recibir el contenido cuando se guarde:</p>
<pre class="code python"><a name="rest_code_c4b6b00157d944339bab03204943ce4b-1"></a><span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-2"></a>        <span class="c1">#Obtenemos nuevamente la instancia del formulario de Compras</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-3"></a>    <span class="n">form_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_form_class</span><span class="p">()</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-4"></a>    <span class="n">form</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_form</span><span class="p">(</span><span class="n">form_class</span><span class="p">)</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-5"></a>    <span class="c1">#Obtenemos el formset pero ya con lo que se le pasa en el POST</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-6"></a>    <span class="n">detalle_compra_form_set</span> <span class="o">=</span> <span class="n">DetalleCompraFormSet</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">)</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-7"></a>    <span class="sd">"""Llamamos a los métodos para validar el formulario de Compra y el formset, si son válidos ambos se llama al método</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-8"></a><span class="sd">    form_valid o en caso contrario se llama al método form_invalid"""</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-9"></a>    <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">is_valid</span><span class="p">()</span> <span class="ow">and</span> <span class="n">detalle_compra_form_set</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-10"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">form_valid</span><span class="p">(</span><span class="n">form</span><span class="p">,</span> <span class="n">detalle_compra_form_set</span><span class="p">)</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-11"></a>    <span class="k">else</span><span class="p">:</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-12"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">form_invalid</span><span class="p">(</span><span class="n">form</span><span class="p">,</span> <span class="n">detalle_compra_form_set</span><span class="p">)</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-13"></a>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-14"></a><span class="k">def</span> <span class="nf">form_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">form</span><span class="p">,</span> <span class="n">detalle_compra_form_set</span><span class="p">):</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-15"></a>        <span class="c1">#Aquí ya guardamos el object de acuerdo a los valores del formulario de Compra</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-16"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-17"></a>    <span class="c1">#Utilizamos el atributo instance del formset para asignarle el valor del objeto Compra creado y que nos indica el modelo Foráneo</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-18"></a>    <span class="n">detalle_compra_form_set</span><span class="o">.</span><span class="n">instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-19"></a>    <span class="c1">#Finalmente guardamos el formset para que tome los valores que tiene</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-20"></a>    <span class="n">detalle_compra_form_set</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-21"></a>    <span class="c1">#Redireccionamos a la ventana del listado de compras</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-22"></a>    <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">success_url</span><span class="p">)</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-23"></a>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-24"></a><span class="k">def</span> <span class="nf">form_invalid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">form</span><span class="p">,</span> <span class="n">detalle_compra_form_set</span><span class="p">):</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-25"></a>        <span class="c1">#Si es inválido el form de Compra o el formset renderizamos los errores</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-26"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">render_to_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">,</span>
<a name="rest_code_c4b6b00157d944339bab03204943ce4b-27"></a>                                                         <span class="n">detalle_compra_form_set</span> <span class="o">=</span> <span class="n">detalle_compra_form_set</span><span class="p">))</span>
</pre>
<p>Creamos el template para la compra en el archivo "compra.html":</p>
<pre class="code html"><a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-1"></a>{% extends "base.html" %}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-2"></a>{% block cuerpo %}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-3"></a>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-4"></a><span class="p">&lt;</span><span class="nt">form</span> <span class="na">role</span><span class="o">=</span><span class="s">"form"</span> <span class="na">action</span><span class="o">=</span><span class="s">"{% url 'productos:crear_compra' %}"</span> <span class="na">method</span><span class="o">=</span><span class="s">"post"</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-5"></a>        <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>Crear Compra<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-6"></a>        {% csrf_token %}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-7"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"panel panel-default"</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-8"></a>                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"panel-body"</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-9"></a>                        {{ form.as_p }}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-10"></a>                        {{ detalle_compra_form_set.management_form }}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-11"></a>                        {% for detalle_compra_form in detalle_compra_form_set %}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-12"></a>                                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"row"</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-13"></a>                                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-lg-4"</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-14"></a>                                                <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>Producto<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-15"></a>                                                {% if detalle_compra_form.producto.errors %}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-16"></a>                                                        {% for error in detalle_compra_form.producto.errors %}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-17"></a>                                                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"alert alert-danger alert-dismissible"</span> <span class="na">role</span><span class="o">=</span><span class="s">"alert"</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-18"></a>                                                                <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">"button"</span> <span class="na">class</span><span class="o">=</span><span class="s">"close"</span> <span class="na">data-dismiss</span><span class="o">=</span><span class="s">"alert"</span> <span class="na">aria-label</span><span class="o">=</span><span class="s">"Close"</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-19"></a>                                                                        <span class="p">&lt;</span><span class="nt">span</span> <span class="na">aria-hidden</span><span class="o">=</span><span class="s">"true"</span><span class="p">&gt;</span><span class="ni">&amp;times;</span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-20"></a>                                                                <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-21"></a>                                                                <span class="p">&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>Error: <span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;</span> {{ error|escape }}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-22"></a>                                                        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-23"></a>                                                        {% endfor %}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-24"></a>                                                {% endif %}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-25"></a>                                                {{ detalle_compra_form.producto }}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-26"></a>                                        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-27"></a>                                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-lg-4"</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-28"></a>                                                <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>Cantidad<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-29"></a>                                                {% if detalle_compra_form.cantidad.errors %}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-30"></a>                                                        {% for error in detalle_compra_form.cantidad.errors %}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-31"></a>                                                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"alert alert-danger alert-dismissible"</span> <span class="na">role</span><span class="o">=</span><span class="s">"alert"</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-32"></a>                                                                <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">"button"</span> <span class="na">class</span><span class="o">=</span><span class="s">"close"</span> <span class="na">data-dismiss</span><span class="o">=</span><span class="s">"alert"</span> <span class="na">aria-label</span><span class="o">=</span><span class="s">"Close"</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-33"></a>                                                                        <span class="p">&lt;</span><span class="nt">span</span> <span class="na">aria-hidden</span><span class="o">=</span><span class="s">"true"</span><span class="p">&gt;</span><span class="ni">&amp;times;</span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-34"></a>                                                                <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-35"></a>                                                                <span class="p">&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>Error: <span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;</span> {{ error|escape }}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-36"></a>                                                        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-37"></a>                                                        {% endfor %}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-38"></a>                                                {% endif %}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-39"></a>                                                {{ detalle_compra_form.cantidad }}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-40"></a>                                        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-41"></a>                                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-lg-4"</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-42"></a>                                                <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>Precio<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-43"></a>                                                {% if detalle_compra_form.precio_compra.errors %}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-44"></a>                                                        {% for error in detalle_compra_form.precio_compra.errors %}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-45"></a>                                                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"alert alert-danger alert-dismissible"</span> <span class="na">role</span><span class="o">=</span><span class="s">"alert"</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-46"></a>                                                                <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">"button"</span> <span class="na">class</span><span class="o">=</span><span class="s">"close"</span> <span class="na">data-dismiss</span><span class="o">=</span><span class="s">"alert"</span> <span class="na">aria-label</span><span class="o">=</span><span class="s">"Close"</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-47"></a>                                                                        <span class="p">&lt;</span><span class="nt">span</span> <span class="na">aria-hidden</span><span class="o">=</span><span class="s">"true"</span><span class="p">&gt;</span><span class="ni">&amp;times;</span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-48"></a>                                                                <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-49"></a>                                                                <span class="p">&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>Error: <span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;</span> {{ error|escape }}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-50"></a>                                                        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-51"></a>                                                        {% endfor %}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-52"></a>                                                {% endif %}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-53"></a>                                                {{ detalle_compra_form.precio_compra }}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-54"></a>                                        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-55"></a>                                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-56"></a>                        {% endfor %}
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-57"></a>                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-58"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-59"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-lg-12 text-right"</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-60"></a>                <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">"submit"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn btn-primary"</span> <span class="na">name</span><span class="o">=</span><span class="s">"submit"</span> <span class="na">value</span><span class="o">=</span><span class="s">"Guardar"</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-61"></a>                <span class="p">&lt;</span><span class="nt">a</span> <span class="na">type</span><span class="o">=</span><span class="s">"button"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn btn-default"</span> <span class="na">href</span><span class="o">=</span><span class="s">"{% url 'productos:listado_compras' %}"</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-62"></a>                        Cancelar
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-63"></a>                <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-64"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-65"></a><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<a name="rest_code_e46bfe7b3e064efc8df82a5ac5b01544-66"></a>{% endblock cuerpo %}
</pre>
<p>Análicemos parte por parte esta plantilla:</p>
<p>Primero renderizamos el formulario de la compra:</p>
<pre class="code html"><a name="rest_code_65634520149347428f1806a08070d68a-1"></a>{{ form.as_p }}
</pre>
<p>Luego renderizamos el management_form del formset que nos indica varios parámetros importantes del formset tales como el total de formularios dentro del formset y la cantidad mínima y máxima de formularios que se pueden crear en el formset:</p>
<pre class="code html"><a name="rest_code_7302707a083a4ed08b23b9756714677b-1"></a>{{ detalle_compra_form_set.management_form }}
</pre>
<p>Hacemos un recorrido al formset renderizando form por form con cada uno de sus campos y sus respectivos errores:</p>
<pre class="code html"><a name="rest_code_f92560ac060542c0bada4861ab8b7101-1"></a>{% for detalle_compra_form in detalle_compra_form_set %}
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-2"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"row"</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-3"></a>                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-lg-4"</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-4"></a>                        <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>Producto<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-5"></a>                        {% if detalle_compra_form.producto.errors %}
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-6"></a>                                {% for error in detalle_compra_form.producto.errors %}
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-7"></a>                                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"alert alert-danger alert-dismissible"</span> <span class="na">role</span><span class="o">=</span><span class="s">"alert"</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-8"></a>                                        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">"button"</span> <span class="na">class</span><span class="o">=</span><span class="s">"close"</span> <span class="na">data-dismiss</span><span class="o">=</span><span class="s">"alert"</span> <span class="na">aria-label</span><span class="o">=</span><span class="s">"Close"</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-9"></a>                                                <span class="p">&lt;</span><span class="nt">span</span> <span class="na">aria-hidden</span><span class="o">=</span><span class="s">"true"</span><span class="p">&gt;</span><span class="ni">&amp;times;</span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-10"></a>                                        <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-11"></a>                                        <span class="p">&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>Error: <span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;</span> {{ error|escape }}
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-12"></a>                                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-13"></a>                                {% endfor %}
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-14"></a>                        {% endif %}
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-15"></a>                        {{ detalle_compra_form.producto }}
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-16"></a>                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-17"></a>                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-lg-4"</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-18"></a>                        <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>Cantidad<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-19"></a>                        {% if detalle_compra_form.cantidad.errors %}
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-20"></a>                                {% for error in detalle_compra_form.cantidad.errors %}
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-21"></a>                                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"alert alert-danger alert-dismissible"</span> <span class="na">role</span><span class="o">=</span><span class="s">"alert"</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-22"></a>                                        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">"button"</span> <span class="na">class</span><span class="o">=</span><span class="s">"close"</span> <span class="na">data-dismiss</span><span class="o">=</span><span class="s">"alert"</span> <span class="na">aria-label</span><span class="o">=</span><span class="s">"Close"</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-23"></a>                                                <span class="p">&lt;</span><span class="nt">span</span> <span class="na">aria-hidden</span><span class="o">=</span><span class="s">"true"</span><span class="p">&gt;</span><span class="ni">&amp;times;</span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-24"></a>                                        <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-25"></a>                                        <span class="p">&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>Error: <span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;</span> {{ error|escape }}
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-26"></a>                                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-27"></a>                                {% endfor %}
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-28"></a>                        {% endif %}
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-29"></a>                        {{ detalle_compra_form.cantidad }}
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-30"></a>                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-31"></a>                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-lg-4"</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-32"></a>                        <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>Precio<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-33"></a>                        {% if detalle_compra_form.precio_compra.errors %}
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-34"></a>                                {% for error in detalle_compra_form.precio_compra.errors %}
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-35"></a>                                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"alert alert-danger alert-dismissible"</span> <span class="na">role</span><span class="o">=</span><span class="s">"alert"</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-36"></a>                                        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">"button"</span> <span class="na">class</span><span class="o">=</span><span class="s">"close"</span> <span class="na">data-dismiss</span><span class="o">=</span><span class="s">"alert"</span> <span class="na">aria-label</span><span class="o">=</span><span class="s">"Close"</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-37"></a>                                                <span class="p">&lt;</span><span class="nt">span</span> <span class="na">aria-hidden</span><span class="o">=</span><span class="s">"true"</span><span class="p">&gt;</span><span class="ni">&amp;times;</span><span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-38"></a>                                        <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-39"></a>                                        <span class="p">&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>Error: <span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;</span> {{ error|escape }}
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-40"></a>                                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-41"></a>                                {% endfor %}
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-42"></a>                        {% endif %}
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-43"></a>                        {{ detalle_compra_form.precio_compra }}
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-44"></a>                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-45"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_f92560ac060542c0bada4861ab8b7101-46"></a>{% endfor %}
</pre>
<p>Finalmente nos debe quedar una imagen para crear compra como la siguiente:</p>
<img alt="/images/blog/crear_compra.png" src="../images/blog/crear_compra.png"><p>Si llenamos los datos correspondientes:</p>
<img alt="/images/blog/crear_compra_datos.png" src="../images/blog/crear_compra_datos.png"><p>Cuando le demos click al botón guardar automáticamente nos guarda los elementos y retorna a la ventana con el listado de las compras:</p>
<img alt="/images/blog/listado_compras_datos.png" src="../images/blog/listado_compras_datos.png"><p>Por ahora no tenemos un detalle de lo guardado pero si lo está haciendo correctamente, en el siguiente post veremos como mostrar los datos guardados en el admin, recuerden que el código del proyecto lo pueden encontrar en la siguiente ubicación:</p>
<p><a class="reference external" href="https://github.com/pythonpiura/modales">Proyecto Modales</a></p>
<p>Hasta la pŕoxima, saludos.</p>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="../posts/creando-nuestro-primer-proyecto/" class="u-url">Creando Nuestro Primer Proyecto</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Comunidad Python Piura
            </span></p>
            <p class="dateline"><a href="../posts/creando-nuestro-primer-proyecto/" rel="bookmark"><time class="published dt-published" datetime="2017-09-18T07:16:54-05:00" title="2017-09-18 07:16">2017-09-18 07:16</time></a></p>
                <p class="commentline">
        
    <a href="../posts/creando-nuestro-primer-proyecto/#disqus_thread" data-disqus-identifier="cache/posts/creando-nuestro-primer-proyecto.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>Con este videotutorial aprenderemos a crear nuestro primer proyecto.</p>
<div class="youtube-video align-center">
<iframe width="425" height="344" src="https://www.youtube.com/embed/e505Ymp2fx0?rel=0&amp;hd=1&amp;wmode=transparent"></iframe>
</div>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="../posts/instalacion-de-django-en-ubuntu/" class="u-url">Instalación de Django en Ubuntu</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Comunidad Python Piura
            </span></p>
            <p class="dateline"><a href="../posts/instalacion-de-django-en-ubuntu/" rel="bookmark"><time class="published dt-published" datetime="2017-09-18T07:14:54-05:00" title="2017-09-18 07:14">2017-09-18 07:14</time></a></p>
                <p class="commentline">
        
    <a href="../posts/instalacion-de-django-en-ubuntu/#disqus_thread" data-disqus-identifier="cache/posts/instalacion-de-django-en-ubuntu.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>Seguimos con los videotutoriales en esta oportunidad tenemos la instalación de Django en Ubuntu.</p>
<div class="youtube-video align-center">
<iframe width="425" height="344" src="https://www.youtube.com/embed/dvgM2bxWUlI?rel=0&amp;hd=1&amp;wmode=transparent"></iframe>
</div>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="../posts/instalacion-de-django-en-windows/" class="u-url">Instalación de Django en Windows</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Comunidad Python Piura
            </span></p>
            <p class="dateline"><a href="../posts/instalacion-de-django-en-windows/" rel="bookmark"><time class="published dt-published" datetime="2017-09-08T13:22:18-05:00" title="2017-09-08 13:22">2017-09-08 13:22</time></a></p>
                <p class="commentline">
        
    <a href="../posts/instalacion-de-django-en-windows/#disqus_thread" data-disqus-identifier="cache/posts/instalacion-de-django-en-windows.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>Compartimos este genial vídeo elaborado por uno de los integrantes mas jóvenes y prometedores de nuestra comunidad.</p>
<div class="youtube-video align-center">
<iframe width="425" height="344" src="https://www.youtube.com/embed/3zOemjskGNU?rel=0&amp;hd=1&amp;wmode=transparent"></iframe>
</div>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="../posts/modales-en-django-con-vistas-basadas-en-clases-y-bootstrap/" class="u-url">Modales en Django con Vistas Basadas en Clases y Bootstrap</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Comunidad Python Piura
            </span></p>
            <p class="dateline"><a href="../posts/modales-en-django-con-vistas-basadas-en-clases-y-bootstrap/" rel="bookmark"><time class="published dt-published" datetime="2017-05-23T22:44:05-05:00" title="2017-05-23 22:44">2017-05-23 22:44</time></a></p>
                <p class="commentline">
        
    <a href="../posts/modales-en-django-con-vistas-basadas-en-clases-y-bootstrap/#disqus_thread" data-disqus-identifier="cache/posts/modales-en-django-con-vistas-basadas-en-clases-y-bootstrap.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>Vamos a hacer lo mismo que en el post anterior pero con la diferencia que ahora usaremos los modales de bootstrap, para ello ya tenemos creados nuestro proyecto "modales" y la aplicación "productos", para hacer las pruebas debemos crear un nuevo modelo llamado "proveedores":</p>
<pre class="code python"><a name="rest_code_c05f5f65e5384574b7f77e27ed2f4f49-1"></a><span class="k">class</span> <span class="nc">Proveedor</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a name="rest_code_c05f5f65e5384574b7f77e27ed2f4f49-2"></a>    <span class="n">ruc</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">max_length</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<a name="rest_code_c05f5f65e5384574b7f77e27ed2f4f49-3"></a>    <span class="n">razon_social</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<a name="rest_code_c05f5f65e5384574b7f77e27ed2f4f49-4"></a>    <span class="n">direccion</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<a name="rest_code_c05f5f65e5384574b7f77e27ed2f4f49-5"></a>    <span class="n">telefono</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span><span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<a name="rest_code_c05f5f65e5384574b7f77e27ed2f4f49-6"></a>    <span class="n">correo</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmailField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<a name="rest_code_c05f5f65e5384574b7f77e27ed2f4f49-7"></a>    <span class="n">estado</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre>
<p>Creamos las vistas correspondientes al listado, creación, modificación y detalle de los proveedores:</p>
<p>archivo: views.py</p>
<pre class="code python"><a name="rest_code_25cfca68f00e4dd59408a7ccc5dc85df-1"></a><span class="k">class</span> <span class="nc">ListadoProveedores</span><span class="p">(</span><span class="n">ListView</span><span class="p">):</span>
<a name="rest_code_25cfca68f00e4dd59408a7ccc5dc85df-2"></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">Proveedor</span>
<a name="rest_code_25cfca68f00e4dd59408a7ccc5dc85df-3"></a>    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">'proveedores.html'</span>
<a name="rest_code_25cfca68f00e4dd59408a7ccc5dc85df-4"></a>    <span class="n">context_object_name</span> <span class="o">=</span> <span class="s1">'proveedores'</span>
<a name="rest_code_25cfca68f00e4dd59408a7ccc5dc85df-5"></a>
<a name="rest_code_25cfca68f00e4dd59408a7ccc5dc85df-6"></a><span class="k">class</span> <span class="nc">CrearProveedor</span><span class="p">(</span><span class="n">CreateView</span><span class="p">):</span>
<a name="rest_code_25cfca68f00e4dd59408a7ccc5dc85df-7"></a>    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">'proveedor.html'</span>
<a name="rest_code_25cfca68f00e4dd59408a7ccc5dc85df-8"></a>    <span class="n">form_class</span> <span class="o">=</span> <span class="n">ProveedorForm</span>
<a name="rest_code_25cfca68f00e4dd59408a7ccc5dc85df-9"></a>    <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">'productos:listado_proveedores'</span><span class="p">)</span>
<a name="rest_code_25cfca68f00e4dd59408a7ccc5dc85df-10"></a>
<a name="rest_code_25cfca68f00e4dd59408a7ccc5dc85df-11"></a><span class="k">class</span> <span class="nc">ModificarProveedor</span><span class="p">(</span><span class="n">UpdateView</span><span class="p">):</span>
<a name="rest_code_25cfca68f00e4dd59408a7ccc5dc85df-12"></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">Proveedor</span>
<a name="rest_code_25cfca68f00e4dd59408a7ccc5dc85df-13"></a>    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">'proveedor.html'</span>
<a name="rest_code_25cfca68f00e4dd59408a7ccc5dc85df-14"></a>    <span class="n">form_class</span> <span class="o">=</span> <span class="n">ProveedorForm</span>
<a name="rest_code_25cfca68f00e4dd59408a7ccc5dc85df-15"></a>    <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">'productos:listado_proveedores'</span><span class="p">)</span>
<a name="rest_code_25cfca68f00e4dd59408a7ccc5dc85df-16"></a>
<a name="rest_code_25cfca68f00e4dd59408a7ccc5dc85df-17"></a><span class="k">class</span> <span class="nc">DetalleProveedor</span><span class="p">(</span><span class="n">DetailView</span><span class="p">):</span>
<a name="rest_code_25cfca68f00e4dd59408a7ccc5dc85df-18"></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">Proveedor</span>
<a name="rest_code_25cfca68f00e4dd59408a7ccc5dc85df-19"></a>    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">'detalle_proveedor.html'</span>
</pre>
<p>El formulario a utilizar tanto para modificación como para la creación del proveedor es uno solo:</p>
<p>archivo: forms.py</p>
<pre class="code python"><a name="rest_code_5711d8c4febb4335912b89f239c010e2-1"></a><span class="k">class</span> <span class="nc">ProveedorForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
<a name="rest_code_5711d8c4febb4335912b89f239c010e2-2"></a>
<a name="rest_code_5711d8c4febb4335912b89f239c010e2-3"></a>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
<a name="rest_code_5711d8c4febb4335912b89f239c010e2-4"></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">Proveedor</span>
<a name="rest_code_5711d8c4febb4335912b89f239c010e2-5"></a>        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'ruc'</span><span class="p">,</span> <span class="s1">'razon_social'</span><span class="p">,</span> <span class="s1">'direccion'</span><span class="p">,</span> <span class="s1">'telefono'</span><span class="p">,</span><span class="s1">'correo'</span><span class="p">,</span> <span class="s1">'estado'</span><span class="p">]</span>
<a name="rest_code_5711d8c4febb4335912b89f239c010e2-6"></a>
<a name="rest_code_5711d8c4febb4335912b89f239c010e2-7"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a name="rest_code_5711d8c4febb4335912b89f239c010e2-8"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">ProveedorForm</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a name="rest_code_5711d8c4febb4335912b89f239c010e2-9"></a>        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">):</span>
<a name="rest_code_5711d8c4febb4335912b89f239c010e2-10"></a>            <span class="k">if</span> <span class="n">field</span> <span class="o">&lt;&gt;</span> <span class="s1">'estado'</span><span class="p">:</span>
<a name="rest_code_5711d8c4febb4335912b89f239c010e2-11"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
<a name="rest_code_5711d8c4febb4335912b89f239c010e2-12"></a>                    <span class="s1">'class'</span><span class="p">:</span> <span class="s1">'form-control'</span>
<a name="rest_code_5711d8c4febb4335912b89f239c010e2-13"></a>                <span class="p">})</span>
</pre>
<p>Ahora debemos modificar nuestro archivo urls.py para poder agregar las nuevas urls:</p>
<p>archivo: urls.py</p>
<pre class="code python"><a name="rest_code_897910a47ac7470ab0d76b78e69df8b9-1"></a><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
<a name="rest_code_897910a47ac7470ab0d76b78e69df8b9-2"></a>        <span class="c1">#.....</span>
<a name="rest_code_897910a47ac7470ab0d76b78e69df8b9-3"></a>    <span class="n">url</span><span class="p">(</span><span class="s1">r'^proveedores/$'</span><span class="p">,</span> <span class="n">ListadoProveedores</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">"listado_proveedores"</span><span class="p">),</span>
<a name="rest_code_897910a47ac7470ab0d76b78e69df8b9-4"></a>    <span class="n">url</span><span class="p">(</span><span class="s1">r'^crear_proveedor/$'</span><span class="p">,</span> <span class="n">CrearProveedor</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">"crear_proveedor"</span><span class="p">),</span>
<a name="rest_code_897910a47ac7470ab0d76b78e69df8b9-5"></a>    <span class="n">url</span><span class="p">(</span><span class="s1">r'^modificar_proveedor/(?P&lt;pk&gt;.+)/$'</span><span class="p">,</span><span class="n">ModificarProveedor</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">"modificar_proveedor"</span><span class="p">),</span>
<a name="rest_code_897910a47ac7470ab0d76b78e69df8b9-6"></a>    <span class="n">url</span><span class="p">(</span><span class="s1">r'^detalle_proveedor/(?P&lt;pk&gt;.+)/$'</span><span class="p">,</span><span class="n">DetalleProveedor</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">"detalle_proveedor"</span><span class="p">),</span>
<a name="rest_code_897910a47ac7470ab0d76b78e69df8b9-7"></a><span class="p">]</span>
</pre>
<p>Veamos primero el archivo proveedores.html que es el template desde donde se van a realizar las demás operaciones:</p>
<p>archivo: proveedores.html</p>
<pre class="code html"><a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-1"></a>{% extends "base.html" %}
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-2"></a>{% block cuerpo %}
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-3"></a><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>Proveedores<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-4"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"row"</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-5"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-lg-10"</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-6"></a>                <span class="p">&lt;</span><span class="nt">a</span> <span class="na">onclick</span><span class="o">=</span><span class="s">"return abrir_modal('{% url 'productos:crear_proveedor' %}')"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn btn-primary"</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-7"></a>                        Crear
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-8"></a>                <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-9"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-10"></a><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-11"></a><span class="p">&lt;</span><span class="nt">hr</span><span class="p">/&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-12"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"row"</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-13"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-lg-12"</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-14"></a>                <span class="p">&lt;</span><span class="nt">table</span> <span class="na">id</span><span class="o">=</span><span class="s">"tabla"</span> <span class="na">class</span><span class="o">=</span><span class="s">"display"</span> <span class="na">cellspacing</span><span class="o">=</span><span class="s">"0"</span> <span class="na">width</span><span class="o">=</span><span class="s">"100%"</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-15"></a>                        <span class="p">&lt;</span><span class="nt">thead</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-16"></a>                                <span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-17"></a>                                        <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">"text-center"</span><span class="p">&gt;</span>RUC<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-18"></a>                                        <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">"text-center"</span><span class="p">&gt;</span>RAZON SOCIAL<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-19"></a>                                        <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">"text-center"</span><span class="p">&gt;</span>DIRECCION<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-20"></a>                                        <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">"text-center"</span><span class="p">&gt;</span>ESTADO<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-21"></a>                                        <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">"text-center"</span><span class="p">&gt;</span>ACCIONES<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-22"></a>                                <span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-23"></a>                        <span class="p">&lt;/</span><span class="nt">thead</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-24"></a>                        <span class="p">&lt;</span><span class="nt">tbody</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-25"></a>                        {% for proveedor in proveedores %}
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-26"></a>                <span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-27"></a>                    <span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;</span>{{ proveedor.ruc }}<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-28"></a>                    <span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;</span>{{ proveedor.razon_social }}<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-29"></a>                    <span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;</span>{{ proveedor.direccion }}<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-30"></a>                    {% if proveedor.estado %}
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-31"></a>                    <span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;</span>ACTIVO<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-32"></a>                    {% else %}
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-33"></a>                    <span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;</span>INACTIVO<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-34"></a>                    {% endif %}
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-35"></a>                    <span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">"text-center"</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-36"></a>                        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">onclick</span><span class="o">=</span><span class="s">"return abrir_modal('{% url 'productos:detalle_proveedor' proveedor.pk %}')"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn"</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-37"></a>                            <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">"glyphicon glyphicon-eye-open"</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-38"></a>                        <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-39"></a>                        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">onclick</span><span class="o">=</span><span class="s">"return abrir_modal('{% url 'productos:modificar_proveedor' proveedor.pk %}')"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn"</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-40"></a>                            <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">"glyphicon glyphicon-edit"</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-41"></a>                        <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-42"></a>                    <span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-43"></a>                                <span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-44"></a>                        {% endfor %}
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-45"></a>                        <span class="p">&lt;/</span><span class="nt">tbody</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-46"></a>                <span class="p">&lt;/</span><span class="nt">table</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-47"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-48"></a><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-49"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"popup"</span> <span class="na">class</span><span class="o">=</span><span class="s">"modal fade"</span> <span class="na">role</span><span class="o">=</span><span class="s">"dialog"</span><span class="p">&gt;</span>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-50"></a>
<a name="rest_code_6ca0e9a6bcc04ec2a690cd5b091b4b69-51"></a><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre>
<p>Tenemos la tabla con el listado de los proveedores ya creados junto con dos enlaces en cada fila de proveedor para poder desplegar el detalle y la modificación del mismo en los modales correspondientes, en la parte final vemos que para mostrar el modal usaremos el div con el id "popup" y con las clases de bootstrap "modal" y "fade" para que la ventana a mostrar sea un modal con un ligero efecto al mostrarse.</p>
<p>Ahora vamos a ver la parte de javascript necesaria para poder mostrar el modal correspondiente:</p>
<pre class="code javascript"><a name="rest_code_d85ca60d312941be96cf4dd18497492e-1"></a><span class="kd">function</span> <span class="nx">abrir_modal</span><span class="p">(</span><span class="nx">url</span><span class="p">)</span>
<a name="rest_code_d85ca60d312941be96cf4dd18497492e-2"></a><span class="p">{</span>
<a name="rest_code_d85ca60d312941be96cf4dd18497492e-3"></a>        <span class="nx">$</span><span class="p">(</span><span class="s1">'#popup'</span><span class="p">).</span><span class="nx">load</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span>
<a name="rest_code_d85ca60d312941be96cf4dd18497492e-4"></a>        <span class="p">{</span>
<a name="rest_code_d85ca60d312941be96cf4dd18497492e-5"></a>                <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">modal</span><span class="p">(</span><span class="s1">'show'</span><span class="p">);</span>
<a name="rest_code_d85ca60d312941be96cf4dd18497492e-6"></a>        <span class="p">});</span>
<a name="rest_code_d85ca60d312941be96cf4dd18497492e-7"></a>        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<a name="rest_code_d85ca60d312941be96cf4dd18497492e-8"></a><span class="p">}</span>
<a name="rest_code_d85ca60d312941be96cf4dd18497492e-9"></a>
<a name="rest_code_d85ca60d312941be96cf4dd18497492e-10"></a><span class="kd">function</span> <span class="nx">cerrar_modal</span><span class="p">()</span>
<a name="rest_code_d85ca60d312941be96cf4dd18497492e-11"></a><span class="p">{</span>
<a name="rest_code_d85ca60d312941be96cf4dd18497492e-12"></a>        <span class="nx">$</span><span class="p">(</span><span class="s1">'#popup'</span><span class="p">).</span><span class="nx">modal</span><span class="p">(</span><span class="s1">'hide'</span><span class="p">);</span>
<a name="rest_code_d85ca60d312941be96cf4dd18497492e-13"></a>        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<a name="rest_code_d85ca60d312941be96cf4dd18497492e-14"></a><span class="p">}</span>
<a name="rest_code_d85ca60d312941be96cf4dd18497492e-15"></a>
<a name="rest_code_d85ca60d312941be96cf4dd18497492e-16"></a><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span>
<a name="rest_code_d85ca60d312941be96cf4dd18497492e-17"></a><span class="p">{</span>
<a name="rest_code_d85ca60d312941be96cf4dd18497492e-18"></a>    <span class="kd">var</span> <span class="nx">table</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#tabla'</span><span class="p">).</span><span class="nx">dataTable</span><span class="p">(</span> <span class="p">{</span>
<a name="rest_code_d85ca60d312941be96cf4dd18497492e-19"></a>        <span class="s2">"language"</span><span class="o">:</span> <span class="p">{</span>
<a name="rest_code_d85ca60d312941be96cf4dd18497492e-20"></a>                <span class="nx">url</span><span class="o">:</span> <span class="s2">"/static/localizacion/es_ES.json"</span>
<a name="rest_code_d85ca60d312941be96cf4dd18497492e-21"></a>        <span class="p">}</span>
<a name="rest_code_d85ca60d312941be96cf4dd18497492e-22"></a>    <span class="p">}</span> <span class="p">);</span>
<a name="rest_code_d85ca60d312941be96cf4dd18497492e-23"></a><span class="p">});</span>
</pre>
<p>Notamos que aquí la forma de trabajo es mas sencilla que cuando la haciamos con JQuery-UI ya que solamente usamos el método load() y mostramos el contenido de la ruta que pasamos como argumento.</p>
<p>Ahora veamos los templates correspondientes a la creación, modificación y detalle del proveedor, en el caso de los dos primeros es un solo template:</p>
<p>archivo: proveedor.html</p>
<pre class="code html"><a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-1"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"modal-dialog modal-lg"</span><span class="p">&gt;</span>
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-2"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"modal-content"</span><span class="p">&gt;</span>
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-3"></a>                {% if object %}
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-4"></a>                <span class="p">&lt;</span><span class="nt">form</span> <span class="na">role</span><span class="o">=</span><span class="s">"form"</span> <span class="na">action</span><span class="o">=</span><span class="s">"{% url 'productos:modificar_proveedor' object.pk %}"</span> <span class="na">method</span><span class="o">=</span><span class="s">"post"</span><span class="p">&gt;</span>
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-5"></a>                {% else %}
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-6"></a>                <span class="p">&lt;</span><span class="nt">form</span> <span class="na">role</span><span class="o">=</span><span class="s">"form"</span> <span class="na">action</span><span class="o">=</span><span class="s">"{% url 'productos:crear_proveedor' %}"</span> <span class="na">method</span><span class="o">=</span><span class="s">"post"</span><span class="p">&gt;</span>
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-7"></a>                {% endif %}
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-8"></a>                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"modal-header"</span><span class="p">&gt;</span>
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-9"></a>                <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">"button"</span> <span class="na">class</span><span class="o">=</span><span class="s">"close"</span> <span class="na">data-dismiss</span><span class="o">=</span><span class="s">"modal"</span><span class="p">&gt;</span>x<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-10"></a>                <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>Modificar Proveedor<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-11"></a>            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-12"></a>            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"modal-body"</span><span class="p">&gt;</span>
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-13"></a>                                {% csrf_token %}
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-14"></a>                                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"panel panel-default"</span><span class="p">&gt;</span>
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-15"></a>                                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"panel-body"</span><span class="p">&gt;</span>
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-16"></a>                                                {{ form.as_p }}
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-17"></a>                                        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-18"></a>                                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-19"></a>                        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-20"></a>                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"modal-footer"</span><span class="p">&gt;</span>
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-21"></a>                                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-lg-12 text-right"</span><span class="p">&gt;</span>
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-22"></a>                                        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">"submit"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn btn-primary"</span> <span class="na">name</span><span class="o">=</span><span class="s">"submit"</span> <span class="na">value</span><span class="o">=</span><span class="s">"Guardar"</span><span class="p">&gt;</span>
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-23"></a>                                        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">"button"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn btn-default"</span> <span class="na">onclick</span><span class="o">=</span><span class="s">"return cerrar_modal()"</span><span class="p">&gt;</span>
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-24"></a>                                                Cancelar
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-25"></a>                                        <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-26"></a>                                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-27"></a>                        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-28"></a>                <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-29"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_b5e5200ff0ca478c84ae1f563012ce5f-30"></a><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre>
<p>archivo: detalle_proveedor.html</p>
<pre class="code html"><a name="rest_code_6b38322727e74cea8094dc741123bf79-1"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"modal-dialog modal-lg"</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-2"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"modal-content"</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-3"></a>                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"modal-header"</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-4"></a>                        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">"button"</span> <span class="na">class</span><span class="o">=</span><span class="s">"close"</span> <span class="na">data-dismiss</span><span class="o">=</span><span class="s">"modal"</span><span class="p">&gt;</span>x<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-5"></a>                        <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>Detalle Proveedor<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-6"></a>                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-7"></a>                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"modal-body"</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-8"></a>                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"row"</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-9"></a>                                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-lg-4"</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-10"></a>                                        <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>RUC:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-11"></a>                                        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>{{ object.ruc }}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-12"></a>                                        <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>RAZÓN SOCIAL:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-13"></a>                                        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>{{ object.razon_social }}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-14"></a>                                        <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>DIRECCIÓN:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-15"></a>                                        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>{{ object.direccion }}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-16"></a>                                        <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>TELÉFONO:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-17"></a>                                        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>{{ object.telefono }}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-18"></a>                                        <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>CORREO:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-19"></a>                                        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>{{ object.correo }}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-20"></a>                                        <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>ESTADO:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-21"></a>                                        {% if object.estado %}
<a name="rest_code_6b38322727e74cea8094dc741123bf79-22"></a>                                                <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>ACTIVO<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-23"></a>                                        {% else %}
<a name="rest_code_6b38322727e74cea8094dc741123bf79-24"></a>                                                <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>INACTIVO<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-25"></a>                                        {% endif %}
<a name="rest_code_6b38322727e74cea8094dc741123bf79-26"></a>                                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-27"></a>                        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-28"></a>                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-29"></a>                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"modal-footer"</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-30"></a>                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-lg-12 text-right"</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-31"></a>                                <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">"button"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn btn-primary"</span> <span class="na">onclick</span><span class="o">=</span><span class="s">"return cerrar_modal()"</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-32"></a>                                        Aceptar
<a name="rest_code_6b38322727e74cea8094dc741123bf79-33"></a>                                <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-34"></a>                        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-35"></a>                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-36"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_6b38322727e74cea8094dc741123bf79-37"></a><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre>
<p>Si todo ha salido bien podemos tener una pantalla como la siguiente:</p>
<img alt="/images/blog/proveedores.png" src="../images/blog/proveedores.png"><p>Y los modales:</p>
<p>Creacion de Nuevo Proveedor:</p>
<img alt="/images/blog/creacion_proveedor.png" src="../images/blog/creacion_proveedor.png"><p>Detalle de Proveedor:</p>
<img alt="/images/blog/detalle_proveedor.png" src="../images/blog/detalle_proveedor.png"><p>Modificacion de Proveedor:</p>
<img alt="/images/blog/modificacion_proveedor.png" src="../images/blog/modificacion_proveedor.png"><p>Para ver los archivos de configuración del proyecto y todo lo demás que no ha sido explicado en este post, pueden acceder al repositorio:</p>
<p><a class="reference external" href="https://github.com/pythonpiura/modales">Proyecto Modales</a></p>
<p>Saludos.</p>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="../posts/modales-en-django-con-vistas-basadas-en-clases-y-jquery-ui/" class="u-url">Modales en Django con Vistas Basadas en Clases y JQuery-UI</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Comunidad Python Piura
            </span></p>
            <p class="dateline"><a href="../posts/modales-en-django-con-vistas-basadas-en-clases-y-jquery-ui/" rel="bookmark"><time class="published dt-published" datetime="2017-05-17T21:02:54-05:00" title="2017-05-17 21:02">2017-05-17 21:02</time></a></p>
                <p class="commentline">
        
    <a href="../posts/modales-en-django-con-vistas-basadas-en-clases-y-jquery-ui/#disqus_thread" data-disqus-identifier="cache/posts/modales-en-django-con-vistas-basadas-en-clases-y-jquery-ui.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>En este post vamos a usar ventanas modales para poder hacer operaciones de visualización, creación y modificación de entidades.
Para este fin hemos creado un proyecto llamado "modales" y una aplicación "productos" donde vamos a tener el modelo Producto, para poder mostrar los modales haremos uso de la librería JQuery-UI y de bootstrap para ayudarnos con el diseño, jquery como librería javascript y Datatables para mostrar las tablas de la manera mas cómoda. Los pormenores de creación del proyecto y la correspondiente aplicación serán obviados por haber sido tratados en artículos anteriores.</p>
<p>Primero creamos nuestro archivo base.html que va a contener la carga de las librerias necesarias:</p>
<p>base.html</p>
<pre class="code html"><a name="rest_code_b330e8761e394c08a1d0876f7392eae2-1"></a><span class="cp">&lt;!DOCTYPE html&gt;</span>
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-2"></a>{% load staticfiles %}
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-3"></a><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">"en"</span><span class="p">&gt;</span>
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-4"></a><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-5"></a>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">"UTF-8"</span><span class="p">&gt;</span>
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-6"></a>    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Modales<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-7"></a>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">"UTF-8"</span><span class="p">&gt;</span>
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-8"></a>    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">"viewport"</span> <span class="na">content</span><span class="o">=</span><span class="s">"width=device-width, initial-scale=1"</span><span class="p">&gt;</span>
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-9"></a>    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">"stylesheet"</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/css"</span> <span class="na">href</span><span class="o">=</span><span class="s">"{% static 'css/bootstrap.min.css' %}"</span><span class="p">&gt;</span>
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-10"></a>    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">"stylesheet"</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/css"</span> <span class="na">href</span><span class="o">=</span><span class="s">"{% static 'css/jquery-ui.css' %}"</span><span class="p">&gt;</span>
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-11"></a>    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">"stylesheet"</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/css"</span> <span class="na">href</span><span class="o">=</span><span class="s">"{% static 'css/jquery.dataTables.min.css'  %}"</span><span class="p">/&gt;</span>
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-12"></a>    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/javascript"</span> <span class="na">src</span><span class="o">=</span><span class="s">"{% static 'js/jquery.js' %}"</span> <span class="na">charset</span><span class="o">=</span><span class="s">"UTF-8"</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-13"></a>    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/javascript"</span> <span class="na">src</span><span class="o">=</span><span class="s">"{% static 'js/bootstrap.min.js' %}"</span> <span class="na">charset</span><span class="o">=</span><span class="s">"UTF-8"</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-14"></a>    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/javascript"</span> <span class="na">src</span><span class="o">=</span><span class="s">"{% static 'js/jquery-ui.js' %}"</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-15"></a>    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/javascript"</span> <span class="na">src</span><span class="o">=</span><span class="s">"{% static 'js/jquery.dataTables.min.js' %}"</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-16"></a><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-17"></a><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-18"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"page-wrapper"</span><span class="p">&gt;</span>
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-19"></a>    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"container-fluid"</span><span class="p">&gt;</span>
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-20"></a>    {% block cuerpo %}
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-21"></a>
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-22"></a>    {% endblock cuerpo %}
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-23"></a>    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-24"></a><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-25"></a><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<a name="rest_code_b330e8761e394c08a1d0876f7392eae2-26"></a><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre>
<p>Vamos a proceder a crear nuestras vistas en el archivos views.py:</p>
<p>views.py</p>
<pre class="code python"><a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-1"></a><span class="c1"># -*- coding: utf-8 -*-</span>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-2"></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">unicode_literals</span>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-3"></a><span class="kn">from</span> <span class="nn">django.views.generic.edit</span> <span class="kn">import</span> <span class="n">UpdateView</span><span class="p">,</span> <span class="n">CreateView</span>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-4"></a><span class="kn">from</span> <span class="nn">django.views.generic.list</span> <span class="kn">import</span> <span class="n">ListView</span>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-5"></a><span class="kn">from</span> <span class="nn">productos.forms</span> <span class="kn">import</span> <span class="n">ProductoForm</span>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-6"></a><span class="kn">from</span> <span class="nn">productos.models</span> <span class="kn">import</span> <span class="n">Producto</span>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-7"></a><span class="kn">from</span> <span class="nn">django.core.urlresolvers</span> <span class="kn">import</span> <span class="n">reverse_lazy</span>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-8"></a><span class="kn">from</span> <span class="nn">django.views.generic.detail</span> <span class="kn">import</span> <span class="n">DetailView</span>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-9"></a>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-10"></a><span class="k">class</span> <span class="nc">ListadoProductos</span><span class="p">(</span><span class="n">ListView</span><span class="p">):</span>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-11"></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">Producto</span>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-12"></a>    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">'productos.html'</span>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-13"></a>    <span class="n">context_object_name</span> <span class="o">=</span> <span class="s1">'productos'</span>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-14"></a>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-15"></a><span class="k">class</span> <span class="nc">CrearProducto</span><span class="p">(</span><span class="n">CreateView</span><span class="p">):</span>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-16"></a>    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">'producto.html'</span>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-17"></a>    <span class="n">form_class</span> <span class="o">=</span> <span class="n">ProductoForm</span>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-18"></a>    <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">'productos:listado_productos'</span><span class="p">)</span>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-19"></a>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-20"></a><span class="k">class</span> <span class="nc">ModificarProducto</span><span class="p">(</span><span class="n">UpdateView</span><span class="p">):</span>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-21"></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">Producto</span>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-22"></a>    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">'producto.html'</span>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-23"></a>    <span class="n">form_class</span> <span class="o">=</span> <span class="n">ProductoForm</span>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-24"></a>    <span class="n">success_url</span> <span class="o">=</span> <span class="n">reverse_lazy</span><span class="p">(</span><span class="s1">'productos:listado_productos'</span><span class="p">)</span>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-25"></a>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-26"></a>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-27"></a><span class="k">class</span> <span class="nc">DetalleProducto</span><span class="p">(</span><span class="n">DetailView</span><span class="p">):</span>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-28"></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">Producto</span>
<a name="rest_code_5a150e524b304fc4b9b4ef34716f4e38-29"></a>    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">'detalle_producto.html'</span>
</pre>
<p>La vista ListadoProductos es la vista principal de nuestra aplicación desde aquí vamos a interactuar con las demás vistas, como se ve todas están basadas en clases.</p>
<p>Debemos crear un formulario llamado ProductoForm para utilizarlo tanto en ModificarProducto como en CrearProducto:</p>
<p>forms.py</p>
<pre class="code python"><a name="rest_code_43620d4b17944fcc944907074e054160-1"></a><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
<a name="rest_code_43620d4b17944fcc944907074e054160-2"></a>
<a name="rest_code_43620d4b17944fcc944907074e054160-3"></a><span class="kn">from</span> <span class="nn">productos.models</span> <span class="kn">import</span> <span class="n">Producto</span>
<a name="rest_code_43620d4b17944fcc944907074e054160-4"></a>
<a name="rest_code_43620d4b17944fcc944907074e054160-5"></a>
<a name="rest_code_43620d4b17944fcc944907074e054160-6"></a><span class="k">class</span> <span class="nc">ProductoForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">ModelForm</span><span class="p">):</span>
<a name="rest_code_43620d4b17944fcc944907074e054160-7"></a>
<a name="rest_code_43620d4b17944fcc944907074e054160-8"></a>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
<a name="rest_code_43620d4b17944fcc944907074e054160-9"></a>        <span class="n">model</span> <span class="o">=</span> <span class="n">Producto</span>
<a name="rest_code_43620d4b17944fcc944907074e054160-10"></a>        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'descripcion'</span><span class="p">,</span> <span class="s1">'marca'</span><span class="p">,</span> <span class="s1">'precio'</span><span class="p">,</span> <span class="s1">'estado'</span><span class="p">]</span>
<a name="rest_code_43620d4b17944fcc944907074e054160-11"></a>
<a name="rest_code_43620d4b17944fcc944907074e054160-12"></a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a name="rest_code_43620d4b17944fcc944907074e054160-13"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">ProductoForm</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a name="rest_code_43620d4b17944fcc944907074e054160-14"></a>        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">):</span>
<a name="rest_code_43620d4b17944fcc944907074e054160-15"></a>            <span class="k">if</span> <span class="n">field</span> <span class="o">&lt;&gt;</span> <span class="s1">'estado'</span><span class="p">:</span>
<a name="rest_code_43620d4b17944fcc944907074e054160-16"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="n">field</span><span class="p">]</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
<a name="rest_code_43620d4b17944fcc944907074e054160-17"></a>                    <span class="s1">'class'</span><span class="p">:</span> <span class="s1">'form-control'</span>
<a name="rest_code_43620d4b17944fcc944907074e054160-18"></a>                <span class="p">})</span>
</pre>
<p>Ĺo único nuevo en la parte de los formularios es que estamos implementando el método __init__ para poder agregar la clase 'form-control' de bootstrap.</p>
<p>Ahora vamos a crear nuestro archivo urls.py:</p>
<pre class="code python"><a name="rest_code_9738dcb6ac8c466a9227ce29218289b6-1"></a><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span>
<a name="rest_code_9738dcb6ac8c466a9227ce29218289b6-2"></a><span class="kn">from</span> <span class="nn">productos.views</span> <span class="kn">import</span> <span class="n">ListadoProductos</span><span class="p">,</span> <span class="n">CrearProducto</span><span class="p">,</span> <span class="n">ModificarProducto</span><span class="p">,</span> <span class="n">DetalleProducto</span>
<a name="rest_code_9738dcb6ac8c466a9227ce29218289b6-3"></a>
<a name="rest_code_9738dcb6ac8c466a9227ce29218289b6-4"></a><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
<a name="rest_code_9738dcb6ac8c466a9227ce29218289b6-5"></a>    <span class="n">url</span><span class="p">(</span><span class="s1">r'^$'</span><span class="p">,</span> <span class="n">ListadoProductos</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">"listado_productos"</span><span class="p">),</span>
<a name="rest_code_9738dcb6ac8c466a9227ce29218289b6-6"></a>    <span class="n">url</span><span class="p">(</span><span class="s1">r'^crear_producto/$'</span><span class="p">,</span> <span class="n">CrearProducto</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">"crear_producto"</span><span class="p">),</span>
<a name="rest_code_9738dcb6ac8c466a9227ce29218289b6-7"></a>    <span class="n">url</span><span class="p">(</span><span class="s1">r'^modificar_producto/(?P&lt;pk&gt;.+)/$'</span><span class="p">,</span><span class="n">ModificarProducto</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">"modificar_producto"</span><span class="p">),</span>
<a name="rest_code_9738dcb6ac8c466a9227ce29218289b6-8"></a>    <span class="n">url</span><span class="p">(</span><span class="s1">r'^detalle_producto/(?P&lt;pk&gt;.+)/$'</span><span class="p">,</span><span class="n">DetalleProducto</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">"detalle_producto"</span><span class="p">),</span>
<a name="rest_code_9738dcb6ac8c466a9227ce29218289b6-9"></a><span class="p">]</span>
</pre>
<p>Ahora si haremos nuestra plantilla principal, llamada productos.html, primero haremos la parte del html y luego la de javascript:</p>
<p>productos.html</p>
<pre class="code html"><a name="rest_code_1a491616cc0249f1b93284767f63669a-1"></a>{% extends "base.html" %}
<a name="rest_code_1a491616cc0249f1b93284767f63669a-2"></a>{% block cuerpo %}
<a name="rest_code_1a491616cc0249f1b93284767f63669a-3"></a><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>Productos<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<a name="rest_code_1a491616cc0249f1b93284767f63669a-4"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"row"</span><span class="p">&gt;</span>
<a name="rest_code_1a491616cc0249f1b93284767f63669a-5"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-lg-10"</span><span class="p">&gt;</span>
<a name="rest_code_1a491616cc0249f1b93284767f63669a-6"></a>                <span class="p">&lt;</span><span class="nt">a</span> <span class="na">onclick</span><span class="o">=</span><span class="s">"return abrir_modal('{% url 'productos:crear_producto' %}','Productos / Nuevo')"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn btn-primary"</span><span class="p">&gt;</span>
<a name="rest_code_1a491616cc0249f1b93284767f63669a-7"></a>                        Crear
<a name="rest_code_1a491616cc0249f1b93284767f63669a-8"></a>                <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a name="rest_code_1a491616cc0249f1b93284767f63669a-9"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_1a491616cc0249f1b93284767f63669a-10"></a><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre>
<p>Aquí primero heredamos de base.html y luego tenemos un botón para crear un nuevo producto, para desplegar el modal se llama a la url correspondiente como primer argumento del método de javascript "abrir_modal" y como segundo el título del modal.:</p>
<pre class="code html"><a name="rest_code_352296a1401948418962be3559aee032-1"></a>onclick="return abrir_modal('{% url 'productos:crear_producto' %}','Productos / Nuevo')"
</pre>
<p>Sigamos viendo nuestro archivo productos.html:</p>
<pre class="code html"><a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-1"></a><span class="p">&lt;</span><span class="nt">hr</span><span class="p">/&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-2"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"row"</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-3"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-lg-12"</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-4"></a>                <span class="p">&lt;</span><span class="nt">table</span> <span class="na">id</span><span class="o">=</span><span class="s">"tabla"</span> <span class="na">class</span><span class="o">=</span><span class="s">"display"</span> <span class="na">cellspacing</span><span class="o">=</span><span class="s">"0"</span> <span class="na">width</span><span class="o">=</span><span class="s">"100%"</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-5"></a>                        <span class="p">&lt;</span><span class="nt">thead</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-6"></a>                                <span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-7"></a>                                        <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">"text-center"</span><span class="p">&gt;</span>DESCRIPCION<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-8"></a>                                        <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">"text-center"</span><span class="p">&gt;</span>MARCA<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-9"></a>                                        <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">"text-center"</span><span class="p">&gt;</span>PRECIO<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-10"></a>                                        <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">"text-center"</span><span class="p">&gt;</span>ESTADO<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-11"></a>                                        <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">"text-center"</span><span class="p">&gt;</span>ACCIONES<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-12"></a>                                <span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-13"></a>                        <span class="p">&lt;/</span><span class="nt">thead</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-14"></a>                        <span class="p">&lt;</span><span class="nt">tbody</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-15"></a>                        {% for producto in productos %}
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-16"></a>        <span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-17"></a>            <span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;</span>{{ producto.descripcion }}<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-18"></a>            <span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;</span>{{ producto.marca }}<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-19"></a>            <span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;</span>{{ producto.precio }}<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-20"></a>            {% if producto.estado %}
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-21"></a>            <span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;</span>ACTIVO<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-22"></a>            {% else %}
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-23"></a>            <span class="p">&lt;</span><span class="nt">td</span><span class="p">&gt;</span>INACTIVO<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-24"></a>            {% endif %}
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-25"></a>            <span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">"text-center"</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-26"></a>                <span class="p">&lt;</span><span class="nt">a</span> <span class="na">onclick</span><span class="o">=</span><span class="s">"return abrir_modal('{% url 'productos:detalle_producto' producto.pk %}','Productos / {{ producto.descripcion }}')"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn"</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-27"></a>                    <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">"glyphicon glyphicon-eye-open"</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-28"></a>                <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-29"></a>                <span class="p">&lt;</span><span class="nt">a</span> <span class="na">onclick</span><span class="o">=</span><span class="s">"return abrir_modal('{% url 'productos:modificar_producto' producto.pk %}','Productos / {{ producto.descripcion }}')"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn"</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-30"></a>                    <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">"glyphicon glyphicon-edit"</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-31"></a>                <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-32"></a>            <span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-33"></a>                        <span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-34"></a>                        {% endfor %}
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-35"></a>                        <span class="p">&lt;/</span><span class="nt">tbody</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-36"></a>                <span class="p">&lt;/</span><span class="nt">table</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-37"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-38"></a><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_f7b796b8745b4efa984d15e89e17a88e-39"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"popup"</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre>
<p>Tenemos la tabla con el listado de los productos ya creados junto con dos enlaces en cada fila de producto para poder desplegar el detalle y la modificación del mismo en los modales correspondientes, tal como se explico arriba, en la parte final vemos que para mostrar el modal usaremos el div con el id "popup".</p>
<p>Ahora vamos a ver la parte de javascript necesaria para poder mostrar el modal correspondiente:</p>
<pre class="code javascript"><a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-1"></a><span class="kd">var</span> <span class="nx">modal</span><span class="p">;</span>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-2"></a>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-3"></a><span class="kd">function</span> <span class="nx">abrir_modal</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">titulo</span><span class="p">)</span>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-4"></a><span class="p">{</span>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-5"></a>    <span class="nx">modal</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#popup'</span><span class="p">).</span><span class="nx">dialog</span><span class="p">(</span>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-6"></a>    <span class="p">{</span>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-7"></a>        <span class="nx">title</span><span class="o">:</span> <span class="nx">titulo</span><span class="p">,</span>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-8"></a>        <span class="nx">modal</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-9"></a>        <span class="nx">width</span><span class="o">:</span> <span class="mi">500</span><span class="p">,</span>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-10"></a>        <span class="nx">resizable</span><span class="o">:</span> <span class="kc">false</span>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-11"></a>    <span class="p">}).</span><span class="nx">dialog</span><span class="p">(</span><span class="s1">'open'</span><span class="p">).</span><span class="nx">load</span><span class="p">(</span><span class="nx">url</span><span class="p">)</span>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-12"></a><span class="p">}</span>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-13"></a>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-14"></a><span class="kd">function</span> <span class="nx">cerrar_modal</span><span class="p">()</span>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-15"></a><span class="p">{</span>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-16"></a>    <span class="nx">modal</span><span class="p">.</span><span class="nx">dialog</span><span class="p">(</span><span class="s2">"close"</span><span class="p">);</span>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-17"></a><span class="p">}</span>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-18"></a>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-19"></a><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-20"></a><span class="p">{</span>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-21"></a>    <span class="kd">var</span> <span class="nx">table</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#tabla'</span><span class="p">).</span><span class="nx">dataTable</span><span class="p">(</span> <span class="p">{</span>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-22"></a>        <span class="s2">"language"</span><span class="o">:</span> <span class="p">{</span>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-23"></a>                <span class="nx">url</span><span class="o">:</span> <span class="s2">"/static/localizacion/es_ES.json"</span>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-24"></a>        <span class="p">}</span>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-25"></a>    <span class="p">}</span> <span class="p">);</span>
<a name="rest_code_8ac1928e7d924f4b99f524522dda7ea6-26"></a><span class="p">});</span>
</pre>
<p>La función abrir_modal usa el método dialog() de JQuery-UI para mostrar un modal cuyo contenido en html va a ser cargado con el método load de acuerdo a la url que estemos tratando de visualizar. Este elemento se guarda en la variable modal.</p>
<p>La función cerrar_modal() utiliza la variable modal, para cerrar el dialogo pasando el parámetro "close".</p>
<p>Finalmente tenemos los templates correspondientes a detalle_producto.html y producto.html:</p>
<p>detalle_producto.html</p>
<pre class="code html"><a name="rest_code_bbed30e813dd44d7a482ec9728f2c36d-1"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"panel panel-default"</span><span class="p">&gt;</span>
<a name="rest_code_bbed30e813dd44d7a482ec9728f2c36d-2"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"panel-body"</span><span class="p">&gt;</span>
<a name="rest_code_bbed30e813dd44d7a482ec9728f2c36d-3"></a>                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"row"</span><span class="p">&gt;</span>
<a name="rest_code_bbed30e813dd44d7a482ec9728f2c36d-4"></a>                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-lg-7"</span><span class="p">&gt;</span>
<a name="rest_code_bbed30e813dd44d7a482ec9728f2c36d-5"></a>                                <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>{{ object.descripcion }}<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
<a name="rest_code_bbed30e813dd44d7a482ec9728f2c36d-6"></a>                        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_bbed30e813dd44d7a482ec9728f2c36d-7"></a>                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_bbed30e813dd44d7a482ec9728f2c36d-8"></a>                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"row"</span><span class="p">&gt;</span>
<a name="rest_code_bbed30e813dd44d7a482ec9728f2c36d-9"></a>                        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-lg-4"</span><span class="p">&gt;</span>
<a name="rest_code_bbed30e813dd44d7a482ec9728f2c36d-10"></a>                                <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>MARCA:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<a name="rest_code_bbed30e813dd44d7a482ec9728f2c36d-11"></a>                                <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>{{ object.marca }}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a name="rest_code_bbed30e813dd44d7a482ec9728f2c36d-12"></a>                                <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>PRECIO:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<a name="rest_code_bbed30e813dd44d7a482ec9728f2c36d-13"></a>                                <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>{{ object.precio }}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a name="rest_code_bbed30e813dd44d7a482ec9728f2c36d-14"></a>                                <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>ESTADO:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<a name="rest_code_bbed30e813dd44d7a482ec9728f2c36d-15"></a>                                {% if object.estado %}
<a name="rest_code_bbed30e813dd44d7a482ec9728f2c36d-16"></a>                                        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>ACTIVO<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a name="rest_code_bbed30e813dd44d7a482ec9728f2c36d-17"></a>                                {% else %}
<a name="rest_code_bbed30e813dd44d7a482ec9728f2c36d-18"></a>                                        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>INACTIVO<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a name="rest_code_bbed30e813dd44d7a482ec9728f2c36d-19"></a>                                {% endif %}
<a name="rest_code_bbed30e813dd44d7a482ec9728f2c36d-20"></a>                        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_bbed30e813dd44d7a482ec9728f2c36d-21"></a>                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_bbed30e813dd44d7a482ec9728f2c36d-22"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_bbed30e813dd44d7a482ec9728f2c36d-23"></a><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre>
<p>producto.html</p>
<pre class="code html"><a name="rest_code_ab84069ea1d147a488f99008dc53df87-1"></a>{% if object %}
<a name="rest_code_ab84069ea1d147a488f99008dc53df87-2"></a><span class="p">&lt;</span><span class="nt">form</span> <span class="na">role</span><span class="o">=</span><span class="s">"form"</span> <span class="na">action</span><span class="o">=</span><span class="s">"{% url 'productos:modificar_producto' object.pk %}"</span> <span class="na">method</span><span class="o">=</span><span class="s">"post"</span><span class="p">&gt;</span>
<a name="rest_code_ab84069ea1d147a488f99008dc53df87-3"></a>{% else %}
<a name="rest_code_ab84069ea1d147a488f99008dc53df87-4"></a><span class="p">&lt;</span><span class="nt">form</span> <span class="na">role</span><span class="o">=</span><span class="s">"form"</span> <span class="na">action</span><span class="o">=</span><span class="s">"{% url 'productos:crear_producto' %}"</span> <span class="na">method</span><span class="o">=</span><span class="s">"post"</span><span class="p">&gt;</span>
<a name="rest_code_ab84069ea1d147a488f99008dc53df87-5"></a>{% endif %}
<a name="rest_code_ab84069ea1d147a488f99008dc53df87-6"></a>        {% csrf_token %}
<a name="rest_code_ab84069ea1d147a488f99008dc53df87-7"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"panel panel-default"</span><span class="p">&gt;</span>
<a name="rest_code_ab84069ea1d147a488f99008dc53df87-8"></a>                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"panel-body"</span><span class="p">&gt;</span>
<a name="rest_code_ab84069ea1d147a488f99008dc53df87-9"></a>                        {{ form.as_p }}
<a name="rest_code_ab84069ea1d147a488f99008dc53df87-10"></a>                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_ab84069ea1d147a488f99008dc53df87-11"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_ab84069ea1d147a488f99008dc53df87-12"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"row"</span><span class="p">&gt;</span>
<a name="rest_code_ab84069ea1d147a488f99008dc53df87-13"></a>                <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"col-lg-12 text-right"</span><span class="p">&gt;</span>
<a name="rest_code_ab84069ea1d147a488f99008dc53df87-14"></a>                        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">"submit"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn btn-primary"</span> <span class="na">name</span><span class="o">=</span><span class="s">"submit"</span> <span class="na">value</span><span class="o">=</span><span class="s">"Guardar"</span><span class="p">&gt;</span>
<a name="rest_code_ab84069ea1d147a488f99008dc53df87-15"></a>                        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">"button"</span> <span class="na">class</span><span class="o">=</span><span class="s">"btn btn-default"</span> <span class="na">onclick</span><span class="o">=</span><span class="s">"return cerrar_modal()"</span><span class="p">&gt;</span>
<a name="rest_code_ab84069ea1d147a488f99008dc53df87-16"></a>                                Cancelar
<a name="rest_code_ab84069ea1d147a488f99008dc53df87-17"></a>                        <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<a name="rest_code_ab84069ea1d147a488f99008dc53df87-18"></a>                <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_ab84069ea1d147a488f99008dc53df87-19"></a>        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a name="rest_code_ab84069ea1d147a488f99008dc53df87-20"></a><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</pre>
<p>Este template tiene de especial que va a ser usado tanto para crear como para modificar el producto, por lo que se procede a preguntar si existe un objeto object, en caso de que sea así la acción a realizar será modificar el producto y sino crear un nuevo producto.</p>
<p>Si todo ha salido bien podemos tener una pantalla como la siguiente:</p>
<img alt="/images/blog/modales_principal.png" src="../images/blog/modales_principal.png"><p>Y los modales:</p>
<p>Creacion de Nuevo Producto:</p>
<img alt="/images/blog/creacion_producto.png" src="../images/blog/creacion_producto.png"><p>Detalle de Producto:</p>
<img alt="/images/blog/detalle_producto.png" src="../images/blog/detalle_producto.png"><p>Modificacion de Producto:</p>
<img alt="/images/blog/modificacion_producto.png" src="../images/blog/modificacion_producto.png"><p>Para ver los archivos de configuración del proyecto y todo lo demás que no ha sido explicado en este post, pueden acceder al repositorio:</p>
<p><a class="reference external" href="https://github.com/pythonpiura/modales">Proyecto Modales</a></p>
<p>Saludos.</p>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="../posts/configurando-django-con-postgresql/" class="u-url">Configurando Django con Postgresql</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Comunidad Python Piura
            </span></p>
            <p class="dateline"><a href="../posts/configurando-django-con-postgresql/" rel="bookmark"><time class="published dt-published" datetime="2017-04-26T21:38:44-05:00" title="2017-04-26 21:38">2017-04-26 21:38</time></a></p>
                <p class="commentline">
        
    <a href="../posts/configurando-django-con-postgresql/#disqus_thread" data-disqus-identifier="cache/posts/configurando-django-con-postgresql.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>En este videotutorial les mostramos la forma de configurar un servidor postgresql y conectarlo con Django, además de utilizar la herramienta gráfica de administración de base de datos PgAdminIII, esperemos les sea útil:</p>
<div class="youtube-video align-center">
<iframe width="425" height="344" src="https://www.youtube.com/embed/n-I3leXp66o?rel=0&amp;hd=1&amp;wmode=transparent"></iframe>
</div>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="../posts/configuracion-de-entorno-de-desarrollo-django/" class="u-url">Configuración de Entorno de Desarrollo Django</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Comunidad Python Piura
            </span></p>
            <p class="dateline"><a href="../posts/configuracion-de-entorno-de-desarrollo-django/" rel="bookmark"><time class="published dt-published" datetime="2017-04-26T21:27:27-05:00" title="2017-04-26 21:27">2017-04-26 21:27</time></a></p>
                <p class="commentline">
        
    <a href="../posts/configuracion-de-entorno-de-desarrollo-django/#disqus_thread" data-disqus-identifier="cache/posts/configuracion-de-entorno-de-desarrollo-django.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>Después de algunos meses de ausencia y de haber superado los fenómenos climáticos que vivimos en nuestra región, volvemos con nuevos contenidos, esta vez vamos a probar con la realización de videotutoriales, empezamos desde lo básico configurando un entorno de desarrollo para Django usando el IDE Pycharm en su versión community y creando un entorno virtual, esperamos que lo disfruten:</p>
<div class="youtube-video align-center">
<iframe width="425" height="344" src="https://www.youtube.com/embed/PFUJv0CykO8?rel=0&amp;hd=1&amp;wmode=transparent"></iframe>
</div>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="../posts/configurando-la-ruta-de-los-addons-en-odoo/" class="u-url">Configurando la Ruta de los Addons en Odoo</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Comunidad Python Piura
            </span></p>
            <p class="dateline"><a href="../posts/configurando-la-ruta-de-los-addons-en-odoo/" rel="bookmark"><time class="published dt-published" datetime="2017-01-21T11:49:24-05:00" title="2017-01-21 11:49">2017-01-21 11:49</time></a></p>
                <p class="commentline">
        
    <a href="../posts/configurando-la-ruta-de-los-addons-en-odoo/#disqus_thread" data-disqus-identifier="cache/posts/configurando-la-ruta-de-los-addons-en-odoo.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>La ruta de los addons es un parámetro de configuración, que lista los directorios donde se buscarán los módulos agregados a Odoo cuando se inicializa una nueva base de datos.
Los directorios listados en la ruta addons se espera que contengan subdirectorios, cada uno de los cuales es un módulo agregado.</p>
<p>Primero ingresamos a la ruta donde tenemos nuestro entorno de Odoo 10 y creamos una carpeta llamada local-addons:</p>
<pre class="code bash"><a name="rest_code_e6fe92189a934f478c5e0a632f36d3ef-1"></a><span class="nb">cd</span> ~/odoo-dev-10/
<a name="rest_code_e6fe92189a934f478c5e0a632f36d3ef-2"></a>mkdir local-addons
</pre>
<p>La carpeta local-addons contendrá los módulos que vamos a desarrollar.</p>
<p>Ahora editamos la configuración de la instancia:</p>
<pre class="code bash"><a name="rest_code_00f81e6dcb1941f2920b950a76a18052-1"></a>nano myodoo.cfg
</pre>
<p>Localizamos la linea  que empieza con addons_path =. Por defecto esta mostrará lo siguiente:</p>
<pre class="code bash"><a name="rest_code_7c7e9d9d03bd4038b0994c0aec43c371-1"></a><span class="nv">addons_path</span> <span class="o">=</span> /home/usuario/odoo-dev-10/odoo/odoo/addons,/home/usuario/odoo-dev-10/odoo/addons
</pre>
<p>Modificamos la linea agregando una coma al final de la linea y añadiendo la ruta donde van a estar nuestros módulos adicionales, en este caso la carpeta local-addons en la ruta /home/usuario/odoo-dev-10:</p>
<pre class="code bash"><a name="rest_code_2729f268e1bf409d9e34e8537e103bfb-1"></a><span class="nv">addons_path</span> <span class="o">=</span> /home/usuario/odoo-dev-10/odoo/odoo/addons,/home/usuario/odoo-dev-10/odoo/addons,/home/usuario/odoo-dev-10/local-addons
</pre>
<p>Ahora reiniciamos nuestra instancia de odoo:</p>
<pre class="code bash"><a name="rest_code_c3030ca4e4224b1985ec0b8f86a53b92-1"></a>python odoo/odoo-bin -c myodoo.cfg
</pre>
<p>Si  nos detenemos a observar la terminal y los avisos que nos lanza Odoo, veremos que en la linea de addons_paths ya nos aparece la carpeta local-addons:</p>
<pre class="code bash"><a name="rest_code_9373df64447a4733ad76b9af127847fe-1"></a>2017-01-21 17:03:58,845 <span class="m">8081</span> INFO ? odoo: addons paths: <span class="o">[</span><span class="s1">'/home/usuario/.local/share/Odoo/addons/10.0'</span>, u<span class="s1">'/home/usuario/odoo-dev-10/odoo/odoo/addons'</span>, u<span class="s1">'/home/usuario/odoo-dev-10/odoo/addons'</span>, u<span class="s1">'/home/usuario/odoo-dev-10/local-addons'</span><span class="o">]</span>
</pre>
<div class="section" id="instalacion-de-modulos-desde-github">
<h2>Instalación de módulos desde GitHub</h2>
<p>GitHub es una gran fuente de módulos de terceros. Muchos desarrolladores de Odoo utilizan GitHub para compartir sus módulos, y la Asociación Comunitaria Odoo(OCA) mantiene colectivamente varios cientos de addons en GitHub.</p>
<p>Vamos a descargar un módulo de Asociación Comunitaria Odoo(OCA), para buscar los que necesitamos podemos ir a:</p>
<p><a class="reference external" href="https://github.com/OCA/">https://github.com/OCA/</a></p>
<p>En esta caso instalaremos algunos módulos que nos permiten tener funcionalidades para administrar centros de salud, para ello debemos situarnos en la carpeta de nuestro entorno de desarrollo y clonar el módulo allí:</p>
<pre class="code bash"><a name="rest_code_01bf3b866516488a8760e9aeb5934986-1"></a><span class="nb">cd</span> ~/odoo-dev-10
<a name="rest_code_01bf3b866516488a8760e9aeb5934986-2"></a>git clone https://github.com/OCA/vertical-medical
</pre>
<p>De acuerdo a la documentación sabemos que estos módulos dependen de otro llamado partner contacto, por lo que también debemos descargarlo para que esté disponible:</p>
<pre class="code bash"><a name="rest_code_ed4b9238821e4a3ba506c535ee50daf9-1"></a>git clone https://github.com/OCA/partner-contact.git
</pre>
<p>Ahora en nuestra carpeta tendremos dos carpetas adicionales tal como se muestra en la imagen:</p>
<img alt="/images/blog/addons4.png" src="../images/blog/addons4.png"><p>Todos los repositorios de códigos de la Asociación Comunitaria Odoo(OCA) tienen sus complementos contenidos en subdirectorios separados, lo cual es coherente con lo que espera de Odoo con respecto a los directorios en la ruta addons, por lo que debemos agregar ambas a la ruta de addons:</p>
<pre class="code bash"><a name="rest_code_28a88d2bec0040d8b7243fdef347fd2e-1"></a>nano myodoo.cfg
</pre>
<p>Modificamos la linea addons_path:</p>
<pre class="code bash"><a name="rest_code_0785d7dc202840718c43412ad939de7d-1"></a><span class="nv">addons_path</span> <span class="o">=</span> /home/usuario/odoo-dev-10/odoo/odoo/addons,/home/usuario/odoo-dev-10/odoo/addons,/home/usuario/odoo-dev-10/local-addons, /home/usuario/odoo-dev-10/partner-contact, /home/usuario/odoo-dev-10/vertical-medical
</pre>
<p>Ahora lanzamos nuestra instancia:</p>
<pre class="code bash"><a name="rest_code_456c93ab89914d0da99e536cec1ead38-1"></a>python odoo/odoo-bin -c myodoo.cfg
</pre>
<p>Ahora nos vamos al navegador para instalar nuestros addons descargados:</p>
<p><a class="reference external" href="https://localhost:8069">https://localhost:8069</a></p>
<p>Recordemos que el usuario y la contraseña por defecto son admin y admin.</p>
<p>Una vez que hayamos ingresado, buscamos el menú Settings(acá lo tenemos como Configuración, debido a que ya cargamos el soporte para idioma Español) y activamos el modo desarrollador:</p>
<img alt="/images/blog/addons1.png" src="../images/blog/addons1.png"><p>Ahora nos vamos al menú Apps y le damos click a la opción "Actualizar lista de aplicaciones":</p>
<img alt="/images/blog/addons2.png" src="../images/blog/addons2.png"><p>Nos desplegará una ventana como la siguiente, donde presionamos el botón actualizar:</p>
<img alt="/images/blog/addons3.png" src="../images/blog/addons3.png"><p>Finalmente vamos a las aplicaciones y buscamos el módulo Odoo Medical:</p>
<img alt="/images/blog/addons5.png" src="../images/blog/addons5.png"><p>Le damos click al botón instalar y automáticamente instalará también el addon partner-contact:</p>
<p>Ya con esto podemos administrar un centro médico con Odoo.</p>
<img alt="/images/blog/addons6.png" src="../images/blog/addons6.png"><p>Saludos.</p>
</div>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="../posts/guardando-la-configuracion-de-una-instancia-de-odoo-en-un-archivo/" class="u-url">Guardando la Configuración de una Instancia de Odoo en un Archivo</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Comunidad Python Piura
            </span></p>
            <p class="dateline"><a href="../posts/guardando-la-configuracion-de-una-instancia-de-odoo-en-un-archivo/" rel="bookmark"><time class="published dt-published" datetime="2017-01-21T11:35:33-05:00" title="2017-01-21 11:35">2017-01-21 11:35</time></a></p>
                <p class="commentline">
        
    <a href="../posts/guardando-la-configuracion-de-una-instancia-de-odoo-en-un-archivo/#disqus_thread" data-disqus-identifier="cache/posts/guardando-la-configuracion-de-una-instancia-de-odoo-en-un-archivo.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>Seguimos configurando un entorno de desarrollo para Odoo 10 y tal como hemos visto en el <a class="reference external" href="../posts/instalando-entorno-de-desarrollo-para-odoo-10-en-ubuntu-1604/">artículo anterior</a> podíamos levantar una instancia de Odoo con algunos parámetros agregados:</p>
<pre class="code bash"><a name="rest_code_e42f3c1509a34358b9fb40018db02091-1"></a>python odoo-bin -d odoo10 --addons-path<span class="o">=</span>addons
</pre>
<p>Odoo tiene múltiples parámetros de configuración, para ver que parámetros podemos utilizar ejecutamos el siguiente comando:</p>
<pre class="code bash"><a name="rest_code_7bfb6f41a31d4ff492f0aa4baf52ad25-1"></a>python odoo-bin --help <span class="p">|</span> less
</pre>
<p>Estar cargando todos estos parámetros cada vez que levantamos nuestra instancia es un poco tedioso, por eso tenemos la opción de guardar un archivo de configuración donde tengamos todos nuestros parámetros establecidos.</p>
<p>Suponiendo que estamos ubicados en la carpeta que contiene el código fuente de Odoo, para generar el archivo de configuración debemos correr el siguiente comando:</p>
<pre class="code bash"><a name="rest_code_71b7e2073c644318be20e09b4878ed76-1"></a>python odoo-bin --save --config myodoo.cfg --stop-after-init
</pre>
<p>De esta manera generamos un archivo de configuración llamado myodoo.cfg(el nombre puede ser cualquiera) que se guardará en la misma carpeta donde está el script odoo-bin.</p>
<p>Es posible guardar este archivo en cualquier ubicación, eso ya depende de nosotros y de como nos ubiquemos para utilizar el script odoo-bin, en nuestro caso siempre creamos el archivo de configuración en la carpeta superior a la que contiene el código fuente de odoo(si seguimos la secuencia del artículo anterior esta carpeta será odoo-dev-10), por lo que haremos lo siguiente:</p>
<pre class="code bash"><a name="rest_code_5baf9e07645b4ed19c70a6161553b68c-1"></a><span class="nb">cd</span> ~/odoo-dev-10
<a name="rest_code_5baf9e07645b4ed19c70a6161553b68c-2"></a>python odoo/odoo-bin --save --config myodoo.cfg --stop-after-init
</pre>
<p>Si editamos el archivo myodoo.cfg y cambiamos algunos de los parámetros, es posible tomar estos cambios la siguiente vez que iniciemos nuestra instancia usando el parámetro -c, que es una opción abreviada de --config:</p>
<pre class="code bash"><a name="rest_code_2f5850d87bcd4d589bac1a7a51daab45-1"></a>python odoo/odoo-bin -c myodoo.cfg
</pre>
<p>Esto funciona de la siguiente manera, al arrancar, Odoo carga su configuración en tres pasos:</p>
<ul class="simple">
<li>Primero se inicializa un conjunto de valores predeterminados para todas las opciones desde el código fuente.</li>
<li>A continuación, se analiza la configuración y cualquier valor definido en el archivo reemplaza los valores predeterminados.</li>
<li>Finalmente, se analizan las opciones de la línea de comandos y sus valores anulan la configuración obtenida del paso anterior.</li>
</ul>
<p>Los nombres de las variables de configuración se pueden transformar desde los nombres de las opciones de la línea de comandos, eliminando los guiones principales y convirtiendo los guiones medios en guiones bajos. Hay algunas excepciones en particular, pero para obtener mayor detalle de esto remitanse a la documentación de Odoo o a los libros que hemos recomendado en los artículos anteriores y que estamos usando como guía.</p>
<p>Saludos.</p>
</div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="next">
                <a href="index-3.html" rel="next">Publicaciones anteriores</a>
            </li>
        </ul></nav><script>var disqus_shortname="pythonpiura-org";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2017         <a href="mailto:pythonpiura@openmailbox.org">Comunidad Python Piura</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a>
            
        </footer>
</div>
</div>


            <script src="../assets/js/all-nocdn.js"></script><script src="../assets/js/colorbox-i18n/jquery.colorbox-es.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("es");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-8661664653028018",
    enable_page_level_ads: true
  });
</script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-76551557-2', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>
